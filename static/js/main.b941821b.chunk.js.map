{"version":3,"sources":["assets/ad.png","wallet-adapters/ledger/core.ts","assets/logo.png","utils/utils.tsx","utils/fetch-loop.tsx","utils/connection.tsx","components/Link.js","utils/notifications.tsx","wallet-adapters/types.ts","wallet-adapters/ledger/index.tsx","wallet-adapters/solong/index.tsx","wallet-adapters/phantom/index.tsx","wallet-adapters/math/index.tsx","utils/wallet.tsx","wallet-adapters/sollet-extension/index.tsx","global_style.ts","components/ErrorBoundary.jsx","utils/send.tsx","utils/tokens.tsx","utils/bonfidaConnector.tsx","utils/markets.tsx","pages/TradePage.tsx","pages/AboutPage.tsx","utils/useInterval.tsx","utils/preferences.tsx","components/Settings.jsx","components/CustomClusterEndpointDialog.tsx","components/LinkAddress.tsx","components/WalletConnect.tsx","components/TopBar.tsx","components/HelpUrls.ts","components/Footer.tsx","components/BasicLayout.js","routes.tsx","App.tsx","serviceWorker.js","index.js"],"names":["module","exports","ledgerSend","transport","instruction","p1","payload","a","p2","payloadOffset","length","chunk","slice","console","log","toString","send","Error","reply","harden","n","getSolanaDerivationPath","account","change","undefined","derivationPath","Buffer","alloc","offset","writeUInt8","writeUInt32BE","signTransaction","transaction","messageBytes","serializeMessage","signBytes","bytes","numPaths","concat","getPublicKey","publicKeyBytes","PublicKey","sleep","ms","Promise","resolve","setTimeout","Intl","NumberFormat","style","minimumFractionDigits","maximumFractionDigits","localStorageListeners","useLocalStorageStringState","key","defaultState","state","localStorage","getItem","useState","notify","useEffect","push","filter","listener","setState","useCallback","newState","removeItem","setItem","forEach","useLocalStorageState","JSON","stringify","stringState","setStringState","useMemo","parse","pageLoadTime","Date","globalCache","Map","FetchLoopListener","cacheKey","fn","refreshInterval","refreshIntervalOnError","callback","cacheNullValues","this","FetchLoopInternal","timeoutId","listeners","errors","refresh","clearTimeout","stopped","errored","data","set","notifyListeners","warn","waitTime","Math","min","timeSincePageLoad","document","visibilityState","hasFocus","random","Set","map","refreshIntervalsOnError","x","size","previousRefreshInterval","add","assert","delete","globalLoops","loops","has","get","addListener","loop","removeListener","all","values","useAsyncData","asyncFn","useReducer","i","rerender","loaded","ENDPOINTS","name","endpoint","custom","ConnectionContext","React","createContext","ConnectionProvider","children","setEndpoint","customEndpoints","setCustomEndpoints","availableEndpoints","connection","Connection","sendConnection","id","onAccountChange","Account","publicKey","removeAccountChangeListener","onSlotChange","removeSlotChangeListener","Provider","value","useConnection","context","useContext","useConnectionConfig","endpointInfo","find","info","Link","external","props","to","rest","href","target","rel","message","description","txid","type","placement","color","notification","opacity","backgroundColor","DEFAULT_PUBLIC_KEY","LedgerWalletAdapter","_connecting","_publicKey","_transport","transactions","result","signed","signature","addSignature","TransportWebUSB","create","emit","disconnect","close","EventEmitter","SolongWalletAdapter","_onProcess","_connected","connect","bind","solong","window","signAllTransactions","selectAccount","then","catch","finally","PhantomWalletAdapter","_handleConnect","args","_handleDisconnect","solana","isPhantom","_provider","isConnected","autoApprove","open","on","MathWalletAdapter","isMathWallet","getAccount","ASSET_URL","WALLET_PROVIDERS","url","icon","adapter","_","network","sollet","Wallet","WalletContext","WalletProvider","autoConnect","setAutoConnect","providerUrl","setProviderUrl","provider","wallet","setWallet","updateWallet","readyState","removeEventListener","addEventListener","connected","setConnected","walletPublicKey","toBase58","substring","isModalVisible","setIsModalVisible","select","providerName","title","okText","visible","okButtonProps","display","onCancel","width","onClick","alt","height","src","marginRight","textAlign","marginBottom","useWallet","setProvider","GlobalStyle","createGlobalStyle","Title","Typography","ErrorBoundary","hasError","level","error","Component","jAddy1","Transaction","SystemProgram","transfer","fromPubkey","toPubkey","lamports","sendTransaction","signers","settleAllFunds","tokenAccounts","markets","selectedTokenAccounts","programIds","reduce","cumulative","m","_programId","programId","p","equals","getOpenOrdersAccountsForProgramId","OpenOrders","findForOwner","openOrdersAccounts","openOrders","baseTokenFree","toNumber","quoteTokenFree","openOrdersAccountsForProgramIds","accounts","current","openOrdersAccount","market","_decoded","ownAddress","isZero","baseMint","baseMintAddress","quoteMint","quoteMintAddress","selectedBaseTokenAccount","getSelectedTokenAccountForMint","pubkey","selectedQuoteTokenAccount","makeSettleFundsTransaction","settleTransactions","t","signer","s","mergeTransactions","getUnixTs","getTime","sendingMessage","sentMessage","successMessage","timeout","sendNotification","signedTransaction","sendSignedTransaction","getRecentBlockhash","recentBlockhash","blockhash","setSigners","partialSign","rawTransaction","serialize","startTime","sendRawTransaction","skipPreflight","done","awaitTransactionSignatureConfirmation","simulateResult","simulateTransaction","err","logs","line","startsWith","parsedErrorInfo","parseInstructionErrorResponse","parsedError","reject","onSignature","e","getSignatureStatuses","signatureStatuses","confirmations","resultDescription","AccountInfoResult","struct","executable","owner","rentEpoch","array","union","jsonRpcVersion","literal","jsonrpc","jsonRpcResult","slot","commitment","_recentBlockhash","_disableBlockhashCaching","signData","wireTransaction","_serialize","encodedTransaction","encoding","_rpcRequest","res","ACCOUNT_LAYOUT","BufferLayout","parseTokenAccountData","decode","mint","amount","getOwnedAccountsFilters","memcmp","offsetOf","dataSize","span","TOKEN_PROGRAM_ID","getOwnedTokenAccounts","filters","resp","accountInfo","bs58","every","filterBytes","getTokenAccountInfo","ownerAddress","getAccountInfo","splAccounts","parsedSplAccounts","effectiveMint","WRAPPED_SOL_MINT","path","fetch","URL","response","ok","json","responseJson","success","marketAddress","BonfidaApi","USE_MARKETS","MARKETS","useUnmigratedOpenOrdersAccounts","deprecatedOpenOrdersAccounts","deprecatedProgramIds","Array","from","deprecated","publicKeyStr","baseTokenTotal","quoteTokenTotal","some","address","tuple","_VERY_SLOW_REFRESH_INTERVAL","clearCache","refreshCache","MarketContext","useCustomMarkets","customMarkets","setCustomMarkets","MarketProvider","setMarketAddress","marketInfos","getMarketInfos","marketInfo","setMarket","BONFIDA_DATA_FEED","marketName","getTradePageUrl","useTokenAccounts","selectedPubKey","filtered","customMarketsInfo","useMarketInfos","Select","Option","OptGroup","Wrapper","styled","div","TradePage","useParams","history","useHistory","TradePageInner","useMarket","process","REACT_APP_EXCLUDE_MARKETS","includes","handleDeprecated","setHandleDeprecated","deprecatedMarkets","marketsList","deps","getMarket","Market","load","openOrdersList","useUnmigratedDeprecatedMarkets","innerHeight","innerWidth","dimensions","setDimensions","changeOrderRef","useRef","handleResize","componentProps","onChangeOrderRef","ref","onPrice","price","onSize","component","Fragment","RenderNormal","justifyContent","paddingBottom","ad","sendToMinter","RenderSmall","flex","RenderSmaller","AboutPage","paddingTop","useInterval","delay","savedCallback","setInterval","clearInterval","PreferencesContext","PreferencesProvider","autoSettleEnabled","setAutoSettleEnabled","marketInfoList","currentlyFetchingMarkets","setCurrentlyFetchingMarkets","setMarkets","addToMarketsMap","marketId","prev","autoSettle","fetchMarkets","Paragraph","Settings","usePreferences","disabled","checked","onChange","marginTop","CustomClusterEndpointDialog","testingConnection","onAddCustomEndpoint","onClose","customEndpoint","setCustomEndpoint","customEndpointName","setCustomEndpointName","onDoClose","canSubmit","onOk","loading","placeholder","addonBefore","LinkAddress","shorten","LinkOutlined","cursor","WalletConnect","menu","Item","Button","overlay","LogoWrapper","EXTERNAL_LINKS","TopBar","addEndpointVisible","setAddEndpointVisible","setTestingConnection","location","useLocation","searchFocussed","handleClick","endpointInfoCustom","handler","tradePageUrl","pathname","handleError","getEpochInfo","newCustomEndpoints","logo","mode","selectedKeys","borderBottom","alignItems","margin","align","paddingLeft","paddingRight","gutter","content","trigger","InfoCircleOutlined","onSelect","SettingOutlined","helpUrls","Footer","Layout","footerElements","Grid","useBreakpoint","link","CustomFooter","elem","index","Header","Content","BasicLayout","minHeight","flexDirection","padding","Routes","basename","exact","App","fallback","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b941821b.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import type Transport from '@ledgerhq/hw-transport';\r\nimport type { Transaction } from '@solana/web3.js';\r\n\r\nimport { PublicKey } from '@solana/web3.js';\r\n\r\nconst INS_GET_PUBKEY = 0x05;\r\nconst INS_SIGN_MESSAGE = 0x06;\r\n\r\nconst P1_NON_CONFIRM = 0x00;\r\nconst P1_CONFIRM = 0x01;\r\n\r\nconst P2_EXTEND = 0x01;\r\nconst P2_MORE = 0x02;\r\n\r\nconst MAX_PAYLOAD = 255;\r\n\r\nconst LEDGER_CLA = 0xe0;\r\n\r\n/*\r\n * Helper for chunked send of large payloads\r\n */\r\nasync function ledgerSend(\r\n  transport: Transport,\r\n  instruction: number,\r\n  p1: number,\r\n  payload: Buffer,\r\n) {\r\n  let p2 = 0;\r\n  let payloadOffset = 0;\r\n\r\n  if (payload.length > MAX_PAYLOAD) {\r\n    while (payload.length - payloadOffset > MAX_PAYLOAD) {\r\n      const chunk = payload.slice(payloadOffset, payloadOffset + MAX_PAYLOAD);\r\n      payloadOffset += MAX_PAYLOAD;\r\n      console.log(\r\n        'send',\r\n        (p2 | P2_MORE).toString(16),\r\n        chunk.length.toString(16),\r\n        chunk,\r\n      );\r\n      const reply = await transport.send(\r\n        LEDGER_CLA,\r\n        instruction,\r\n        p1,\r\n        p2 | P2_MORE,\r\n        chunk,\r\n      );\r\n      if (reply.length !== 2) {\r\n        throw new Error('Received unexpected reply payload');\r\n      }\r\n      p2 |= P2_EXTEND;\r\n    }\r\n  }\r\n\r\n  const chunk = payload.slice(payloadOffset);\r\n  console.log('send', p2.toString(16), chunk.length.toString(16), chunk);\r\n  const reply = await transport.send(LEDGER_CLA, instruction, p1, p2, chunk);\r\n\r\n  return reply.slice(0, reply.length - 2);\r\n}\r\n\r\nconst BIP32_HARDENED_BIT = (1 << 31) >>> 0;\r\nfunction harden(n: number = 0) {\r\n  return (n | BIP32_HARDENED_BIT) >>> 0;\r\n}\r\n\r\nexport function getSolanaDerivationPath(account?: number, change?: number) {\r\n  var length;\r\n  if (account !== undefined) {\r\n    if (change !== undefined) {\r\n      length = 4;\r\n    } else {\r\n      length = 3;\r\n    }\r\n  } else {\r\n    length = 2;\r\n  }\r\n\r\n  var derivationPath = Buffer.alloc(1 + length * 4);\r\n  // eslint-disable-next-line\r\n  var offset = 0;\r\n  offset = derivationPath.writeUInt8(length, offset);\r\n  offset = derivationPath.writeUInt32BE(harden(44), offset); // Using BIP44\r\n  offset = derivationPath.writeUInt32BE(harden(501), offset); // Solana's BIP44 path\r\n\r\n  if (length > 2) {\r\n    offset = derivationPath.writeUInt32BE(harden(account), offset);\r\n    if (length === 4) {\r\n      // @FIXME: https://github.com/project-serum/spl-token-wallet/issues/59\r\n      offset = derivationPath.writeUInt32BE(harden(change), offset);\r\n    }\r\n  }\r\n\r\n  return derivationPath;\r\n}\r\n\r\nexport async function signTransaction(\r\n  transport: Transport,\r\n  transaction: Transaction,\r\n  derivationPath: Buffer = getSolanaDerivationPath(),\r\n) {\r\n  const messageBytes = transaction.serializeMessage();\r\n  return signBytes(transport, messageBytes, derivationPath);\r\n}\r\n\r\nexport async function signBytes(\r\n  transport: Transport,\r\n  bytes: Buffer,\r\n  derivationPath: Buffer = getSolanaDerivationPath(),\r\n) {\r\n  const numPaths = Buffer.alloc(1);\r\n  numPaths.writeUInt8(1, 0);\r\n\r\n  const payload = Buffer.concat([numPaths, derivationPath, bytes]);\r\n\r\n  // @FIXME: must enable blind signing in Solana Ledger App per https://github.com/project-serum/spl-token-wallet/issues/71\r\n  // See also https://github.com/project-serum/spl-token-wallet/pull/23#issuecomment-712317053\r\n  return ledgerSend(transport, INS_SIGN_MESSAGE, P1_CONFIRM, payload);\r\n}\r\n\r\nexport async function getPublicKey(\r\n  transport: Transport,\r\n  derivationPath: Buffer = getSolanaDerivationPath(),\r\n) {\r\n  const publicKeyBytes = await ledgerSend(\r\n    transport,\r\n    INS_GET_PUBKEY,\r\n    P1_NON_CONFIRM,\r\n    derivationPath,\r\n  );\r\n\r\n  return new PublicKey(publicKeyBytes);\r\n}\r\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAS/SURBVHhe7dyx669THMDx7/O93fufGJQMGO5kUgYZZCAlSjIYGIURGclg0B10F3dhYEDpppBEyWIwUUpK9nsHvr96xkd99X1Ov57f+/Wq0z3beTr33nef4fSd7vrx0392QNJ+/hMIEgAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIm+757nNPgSHKBABhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBh09Wvv/ASEKJMABAmABAmABAmABAmABAmABAmABAmABAmABAmABA23X/zpqfAEGUCgDABgDABgDABgDABgDABgDABgDABgDABgDABgLDpgc++9BQYokwAECYAECYAECYAECYAECYAECYAECYAECYAEDY99PFXXgJClAkAwgQAwgQAwgQAwgQAwgQAwgQAwgQAwgQAwgQAwqZHPvrGU2CIMgFAmABAmABAmABAmABAmABAmABAmABAmABAmABA2PTYB98e/RT4xuNX513T4a7m3Xrc6XbudMS3njcTAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIRNT77//dEvAa8/dd+8azrc1bxbjzvdzp2O+NbzZgKAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAsOmZ9344+inwtWfvnXfrOZw/75q2dKdb+dYR33nmIv5bNQFAmABAmABAmABAmABAmABAmABAmABAmABAmABA2P7y7f3u2DXC0jmlNcLSOWusEZbOOXWNsnTW1pcJAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMIEAMKmF9766egfBX37xbvnXdPhrubdekbc6YjvPLOVbx3173TUvZ4nEwCECQCECQCECQCECQCECQCECQCECQCECQCECQCE7a/c2u+OXXVLd3LqGmHpnDXWCEvnnLpGWTpr68v/aggTAAgTAAgTAAgTAAgTAAgTAAgTAAgTAAgTAAibXnnt56N/FXgrXn/1znm3rsNdzbv1jPjWEd95ZivfuqW///NmAoAwAYAwAYAwAYAwAYAwAYAwAYAwAYAwAYCw/eVbl3YXbY2ydNapa4Slc9ZYIyydc+oaZemsrS8TAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIRNb7z0y9E/Cvrym3fMu6bDXc279bhTd7q2/3OnJgAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAI21+5fWl37KpbupNTV93SnZy66pbu5L+WCQDCBADCBADCBADCBADCBADCBADCBADCBADCpnee//XoHwUFLhYTAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIQJAIRN7z73m6fAEGUCgDABgDABgDABgDABgDABgDABgDABgDABgDABgLDp2tO/ewoMUSYACBMACBMACBMACBMACBMACBMACBMACBMACJuuP/GHl4AQZQKAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAMAGAsOnGo396CgxRJgAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAIEwAImz58+C9PgSHKBABhAgBhAgBhAgBhAgBhAgBhAgBhAgBhAgBh0ycP/u0lIESZACBMACBMACBMACBMACBMACBMACBMACBMACBMACBrt/sXmM2S4SHv/1wAAAAASUVORK5CYII=\"","import { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { PublicKey } from '@solana/web3.js';\r\nimport BN from 'bn.js';\r\n\r\nexport function isValidPublicKey(key) {\r\n  if (!key) {\r\n    return false;\r\n  }\r\n  try {\r\n    new PublicKey(key);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function sleep(ms) {\r\n  return new Promise((resolve) => setTimeout(resolve, ms));\r\n}\r\n\r\nexport const percentFormat = new Intl.NumberFormat(undefined, {\r\n  style: 'percent',\r\n  minimumFractionDigits: 2,\r\n  maximumFractionDigits: 2,\r\n});\r\n\r\nexport function floorToDecimal(\r\n  value: number,\r\n  decimals: number | undefined | null,\r\n) {\r\n  return decimals\r\n    ? Math.floor(value * 10 ** decimals) / 10 ** decimals\r\n    : Math.floor(value);\r\n}\r\n\r\nexport function roundToDecimal(\r\n  value: number,\r\n  decimals: number | undefined | null,\r\n) {\r\n  return decimals ? Math.round(value * 10 ** decimals) / 10 ** decimals : value;\r\n}\r\n\r\nexport function getDecimalCount(value): number {\r\n  if (\r\n    !isNaN(value) &&\r\n    Math.floor(value) !== value &&\r\n    value.toString().includes('.')\r\n  )\r\n    return value.toString().split('.')[1].length || 0;\r\n  if (\r\n    !isNaN(value) &&\r\n    Math.floor(value) !== value &&\r\n    value.toString().includes('e')\r\n  )\r\n    return parseInt(value.toString().split('e-')[1] || '0');\r\n  return 0;\r\n}\r\n\r\nexport function divideBnToNumber(numerator: BN, denominator: BN): number {\r\n  const quotient = numerator.div(denominator).toNumber();\r\n  const rem = numerator.umod(denominator);\r\n  const gcd = rem.gcd(denominator);\r\n  return quotient + rem.div(gcd).toNumber() / denominator.div(gcd).toNumber();\r\n}\r\n\r\nexport function getTokenMultiplierFromDecimals(decimals: number): BN {\r\n  return new BN(10).pow(new BN(decimals));\r\n}\r\n\r\nconst localStorageListeners = {};\r\n\r\nexport function useLocalStorageStringState(\r\n  key: string,\r\n  defaultState: string | null = null,\r\n): [string | null, (newState: string | null) => void] {\r\n  const state = localStorage.getItem(key) || defaultState;\r\n\r\n  const [, notify] = useState(key + '\\n' + state);\r\n\r\n  useEffect(() => {\r\n    if (!localStorageListeners[key]) {\r\n      localStorageListeners[key] = [];\r\n    }\r\n    localStorageListeners[key].push(notify);\r\n    return () => {\r\n      localStorageListeners[key] = localStorageListeners[key].filter(\r\n        (listener) => listener !== notify,\r\n      );\r\n      if (localStorageListeners[key].length === 0) {\r\n        delete localStorageListeners[key];\r\n      }\r\n    };\r\n  }, [key]);\r\n\r\n  const setState = useCallback<(newState: string | null) => void>(\r\n    (newState) => {\r\n      const changed = state !== newState;\r\n      if (!changed) {\r\n        return;\r\n      }\r\n\r\n      if (newState === null) {\r\n        localStorage.removeItem(key);\r\n      } else {\r\n        localStorage.setItem(key, newState);\r\n      }\r\n      localStorageListeners[key].forEach((listener) =>\r\n        listener(key + '\\n' + newState),\r\n      );\r\n    },\r\n    [state, key],\r\n  );\r\n\r\n  return [state, setState];\r\n}\r\n\r\nexport function useLocalStorageState<T = any>(\r\n  key: string,\r\n  defaultState: T | null = null,\r\n): [T, (newState: T) => void] {\r\n  let [stringState, setStringState] = useLocalStorageStringState(\r\n    key,\r\n    JSON.stringify(defaultState),\r\n  );\r\n  return [\r\n    useMemo(() => stringState && JSON.parse(stringState), [stringState]),\r\n    (newState) => setStringState(JSON.stringify(newState)),\r\n  ];\r\n}\r\n\r\nexport function useEffectAfterTimeout(effect, timeout) {\r\n  useEffect(() => {\r\n    const handle = setTimeout(effect, timeout);\r\n    return () => clearTimeout(handle);\r\n  });\r\n}\r\n\r\nexport function useListener(emitter, eventName) {\r\n  const [, forceUpdate] = useState(0);\r\n  useEffect(() => {\r\n    const listener = () => forceUpdate((i) => i + 1);\r\n    emitter.on(eventName, listener);\r\n    return () => emitter.removeListener(eventName, listener);\r\n  }, [emitter, eventName]);\r\n}\r\n\r\nexport function abbreviateAddress(address: PublicKey, size = 4) {\r\n  const base58 = address.toBase58();\r\n  return base58.slice(0, size) + '…' + base58.slice(-size);\r\n}\r\n\r\nexport function isEqual(obj1, obj2, keys) {\r\n  if (!keys && Object.keys(obj1).length !== Object.keys(obj2).length) {\r\n    return false;\r\n  }\r\n  keys = keys || Object.keys(obj1);\r\n  for (const k of keys) {\r\n    if (obj1[k] !== obj2[k]) {\r\n      // shallow comparison\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n","import { useEffect, useReducer } from 'react';\r\n\r\nimport assert from 'assert';\r\n\r\nconst pageLoadTime = new Date();\r\n\r\nconst globalCache: Map<any, any> = new Map();\r\n\r\nclass FetchLoopListener<T = any> {\r\n  cacheKey: any;\r\n  fn: () => Promise<T>;\r\n  refreshInterval: number;\r\n  refreshIntervalOnError: number | null;\r\n  callback: () => void;\r\n  cacheNullValues: Boolean = true;\r\n\r\n  constructor(\r\n    cacheKey: any,\r\n    fn: () => Promise<T>,\r\n    refreshInterval: number,\r\n    refreshIntervalOnError: number | null,\r\n    callback: () => void,\r\n    cacheNullValues: Boolean,\r\n  ) {\r\n    this.cacheKey = cacheKey;\r\n    this.fn = fn;\r\n    this.refreshInterval = refreshInterval;\r\n    this.refreshIntervalOnError = refreshIntervalOnError;\r\n    this.callback = callback;\r\n    this.cacheNullValues = cacheNullValues;\r\n  }\r\n}\r\n\r\nclass FetchLoopInternal<T = any> {\r\n  cacheKey: any;\r\n  fn: () => Promise<T>;\r\n  timeoutId: null | any;\r\n  listeners: Set<FetchLoopListener<T>>;\r\n  errors: number;\r\n  cacheNullValues: Boolean = true;\r\n\r\n  constructor(cacheKey: any, fn: () => Promise<T>, cacheNullValues: Boolean) {\r\n    this.cacheKey = cacheKey;\r\n    this.fn = fn;\r\n    this.timeoutId = null;\r\n    this.listeners = new Set();\r\n    this.errors = 0;\r\n    this.cacheNullValues = cacheNullValues;\r\n  }\r\n\r\n  get refreshInterval(): number {\r\n    return Math.min(\r\n      ...[...this.listeners].map((listener) => listener.refreshInterval),\r\n    );\r\n  }\r\n\r\n  get refreshIntervalOnError(): number | null {\r\n    const refreshIntervalsOnError: number[] = [...this.listeners]\r\n      .map((listener) => listener.refreshIntervalOnError)\r\n      .filter((x): x is number => x !== null);\r\n    if (refreshIntervalsOnError.length === 0) {\r\n      return null;\r\n    }\r\n    return Math.min(...refreshIntervalsOnError);\r\n  }\r\n\r\n  get stopped(): boolean {\r\n    return this.listeners.size === 0;\r\n  }\r\n\r\n  addListener(listener: FetchLoopListener<T>): void {\r\n    const previousRefreshInterval = this.refreshInterval;\r\n    this.listeners.add(listener);\r\n    if (this.refreshInterval < previousRefreshInterval) {\r\n      this.refresh();\r\n    }\r\n  }\r\n\r\n  removeListener(listener: FetchLoopListener<T>): void {\r\n    assert(this.listeners.delete(listener));\r\n    if (this.stopped) {\r\n      if (this.timeoutId) {\r\n        clearTimeout(this.timeoutId);\r\n        this.timeoutId = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  notifyListeners(): void {\r\n    this.listeners.forEach((listener) => listener.callback());\r\n  }\r\n\r\n  refresh = async () => {\r\n    if (this.timeoutId) {\r\n      clearTimeout(this.timeoutId);\r\n      this.timeoutId = null;\r\n    }\r\n    if (this.stopped) {\r\n      return;\r\n    }\r\n\r\n    let errored = false;\r\n    try {\r\n      const data = await this.fn();\r\n      if (!this.cacheNullValues && data === null) {\r\n        console.log(`Not caching null value for ${this.cacheKey}`);\r\n        // cached data has not changed so no need to re-render\r\n        this.errors = 0;\r\n        return data;\r\n      } else {\r\n        globalCache.set(this.cacheKey, data);\r\n        this.errors = 0;\r\n        this.notifyListeners();\r\n        return data;\r\n      }\r\n    } catch (error) {\r\n      ++this.errors;\r\n      console.warn(error);\r\n      errored = true;\r\n    } finally {\r\n      if (!this.timeoutId && !this.stopped) {\r\n        let waitTime = this.refreshInterval;\r\n        if (\r\n          errored &&\r\n          this.refreshIntervalOnError &&\r\n          this.refreshIntervalOnError > 0\r\n        ) {\r\n          waitTime = this.refreshIntervalOnError;\r\n        }\r\n\r\n        // Back off on errors.\r\n        if (this.errors > 0) {\r\n          waitTime = Math.min(1000 * 2 ** (this.errors - 1), 60000);\r\n        }\r\n\r\n        // Don't do any refreshing for the first five seconds, to make way for other things to load.\r\n        const timeSincePageLoad = +new Date() - +pageLoadTime;\r\n        if (timeSincePageLoad < 5000) {\r\n          waitTime += 5000 - timeSincePageLoad / 2;\r\n        }\r\n\r\n        // Refresh background pages slowly.\r\n        if (document.visibilityState === 'hidden') {\r\n          waitTime = 60000;\r\n        } else if (!document.hasFocus()) {\r\n          waitTime *= 1.5;\r\n        }\r\n\r\n        // Add jitter so we don't send all requests at the same time.\r\n        waitTime *= 0.8 + 0.4 * Math.random();\r\n\r\n        this.timeoutId = setTimeout(this.refresh, waitTime);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nclass FetchLoops {\r\n  loops = new Map();\r\n\r\n  addListener<T>(listener: FetchLoopListener<T>) {\r\n    if (!this.loops.has(listener.cacheKey)) {\r\n      this.loops.set(\r\n        listener.cacheKey,\r\n        new FetchLoopInternal<T>(\r\n          listener.cacheKey,\r\n          listener.fn,\r\n          listener.cacheNullValues,\r\n        ),\r\n      );\r\n    }\r\n    this.loops.get(listener.cacheKey).addListener(listener);\r\n  }\r\n\r\n  removeListener<T>(listener: FetchLoopListener<T>) {\r\n    const loop = this.loops.get(listener.cacheKey);\r\n    loop.removeListener(listener);\r\n    if (loop.stopped) {\r\n      this.loops.delete(listener.cacheKey);\r\n      globalCache.delete(listener.cacheKey);\r\n    }\r\n  }\r\n\r\n  refresh(cacheKey) {\r\n    if (this.loops.has(cacheKey)) {\r\n      this.loops.get(cacheKey).refresh();\r\n    }\r\n  }\r\n\r\n  refreshAll() {\r\n    return Promise.all([...this.loops.values()].map((loop) => loop.refresh()));\r\n  }\r\n}\r\nconst globalLoops = new FetchLoops();\r\n\r\nexport function useAsyncData<T = any>(\r\n  asyncFn: () => Promise<T>,\r\n  cacheKey: any,\r\n  { refreshInterval = 60000, refreshIntervalOnError = null } = {},\r\n  cacheNullValues: Boolean = true,\r\n): [null | undefined | T, boolean] {\r\n  const [, rerender] = useReducer((i) => i + 1, 0);\r\n\r\n  useEffect(() => {\r\n    if (!cacheKey) {\r\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n      return () => {};\r\n    }\r\n    const listener = new FetchLoopListener<T>(\r\n      cacheKey,\r\n      asyncFn,\r\n      refreshInterval,\r\n      refreshIntervalOnError,\r\n      rerender,\r\n      cacheNullValues,\r\n    );\r\n    globalLoops.addListener(listener);\r\n    return () => globalLoops.removeListener(listener);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [cacheKey, refreshInterval]);\r\n\r\n  if (!cacheKey) {\r\n    return [null, false];\r\n  }\r\n\r\n  const loaded = globalCache.has(cacheKey);\r\n  const data = loaded ? globalCache.get(cacheKey) : undefined;\r\n  return [data, loaded];\r\n}\r\n\r\nexport function refreshCache(cacheKey: any, clearCache = false): void {\r\n  if (clearCache) {\r\n    globalCache.delete(cacheKey);\r\n  }\r\n  const loop = globalLoops.loops.get(cacheKey);\r\n  if (loop) {\r\n    loop.refresh();\r\n    if (clearCache) {\r\n      loop.notifyListeners();\r\n    }\r\n  }\r\n}\r\n\r\nexport function refreshAllCaches(): void {\r\n  for (const loop of globalLoops.loops.values()) {\r\n    loop.refresh();\r\n  }\r\n}\r\n\r\nexport function setCache(\r\n  cacheKey: any,\r\n  value: any,\r\n  { initializeOnly = false } = {},\r\n): void {\r\n  if (initializeOnly && globalCache.has(cacheKey)) {\r\n    return;\r\n  }\r\n  globalCache.set(cacheKey, value);\r\n  const loop = globalLoops.loops.get(cacheKey);\r\n  if (loop) {\r\n    loop.notifyListeners();\r\n  }\r\n}\r\n\r\nexport function getCache(\r\n  cacheKey: any\r\n) {\r\n  return globalCache.get(cacheKey);\r\n}\r\n","import { useLocalStorageState } from './utils';\r\nimport { Account, AccountInfo, Connection, PublicKey } from '@solana/web3.js';\r\nimport React, { useContext, useEffect, useMemo, useRef } from 'react';\r\nimport { setCache, useAsyncData } from './fetch-loop';\r\nimport tuple from 'immutable-tuple';\r\nimport { ConnectionContextValues, EndpointInfo } from './types';\r\n\r\nexport const ENDPOINTS: EndpointInfo[] = [\r\n  {\r\n    name: 'mainnet-beta',\r\n    endpoint: 'https://solana-api.projectserum.com',\r\n    custom: false,\r\n  },\r\n  { name: 'localnet', endpoint: 'http://127.0.0.1:8899', custom: false },\r\n];\r\n\r\nconst accountListenerCount = new Map();\r\n\r\nconst ConnectionContext: React.Context<null | ConnectionContextValues> = React.createContext<null | ConnectionContextValues>(\r\n  null,\r\n);\r\n\r\nexport function ConnectionProvider({ children }) {\r\n  const [endpoint, setEndpoint] = useLocalStorageState<string>(\r\n    'connectionEndpts',\r\n    ENDPOINTS[0].endpoint,\r\n  );\r\n  const [customEndpoints, setCustomEndpoints] = useLocalStorageState<\r\n    EndpointInfo[]\r\n  >('customConnectionEndpoints', []);\r\n  const availableEndpoints = ENDPOINTS.concat(customEndpoints);\r\n\r\n  const connection = useMemo(() => new Connection(endpoint, 'recent'), [\r\n    endpoint,\r\n  ]);\r\n  const sendConnection = useMemo(() => new Connection(endpoint, 'recent'), [\r\n    endpoint,\r\n  ]);\r\n\r\n  // The websocket library solana/web3.js uses closes its websocket connection when the subscription list\r\n  // is empty after opening its first time, preventing subsequent subscriptions from receiving responses.\r\n  // This is a hack to prevent the list from every getting empty\r\n  useEffect(() => {\r\n    const id = connection.onAccountChange(new Account().publicKey, () => {});\r\n    return () => {\r\n      connection.removeAccountChangeListener(id);\r\n    };\r\n  }, [connection]);\r\n\r\n  useEffect(() => {\r\n    const id = connection.onSlotChange(() => null);\r\n    return () => {\r\n      connection.removeSlotChangeListener(id);\r\n    };\r\n  }, [connection]);\r\n\r\n  useEffect(() => {\r\n    const id = sendConnection.onAccountChange(\r\n      new Account().publicKey,\r\n      () => {},\r\n    );\r\n    return () => {\r\n      sendConnection.removeAccountChangeListener(id);\r\n    };\r\n  }, [sendConnection]);\r\n\r\n  useEffect(() => {\r\n    const id = sendConnection.onSlotChange(() => null);\r\n    return () => {\r\n      sendConnection.removeSlotChangeListener(id);\r\n    };\r\n  }, [sendConnection]);\r\n\r\n  return (\r\n    <ConnectionContext.Provider\r\n      value={{\r\n        endpoint,\r\n        setEndpoint,\r\n        connection,\r\n        sendConnection,\r\n        availableEndpoints,\r\n        setCustomEndpoints,\r\n      }}\r\n    >\r\n      {children}\r\n    </ConnectionContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useConnection() {\r\n  const context = useContext(ConnectionContext);\r\n  if (!context) {\r\n    throw new Error('Missing connection context');\r\n  }\r\n  return context.connection;\r\n}\r\n\r\nexport function useSendConnection() {\r\n  const context = useContext(ConnectionContext);\r\n  if (!context) {\r\n    throw new Error('Missing connection context');\r\n  }\r\n  return context.sendConnection;\r\n}\r\n\r\nexport function useConnectionConfig() {\r\n  const context = useContext(ConnectionContext);\r\n  if (!context) {\r\n    throw new Error('Missing connection context');\r\n  }\r\n  return {\r\n    endpoint: context.endpoint,\r\n    endpointInfo: context.availableEndpoints.find(\r\n      (info) => info.endpoint === context.endpoint,\r\n    ),\r\n    setEndpoint: context.setEndpoint,\r\n    availableEndpoints: context.availableEndpoints,\r\n    setCustomEndpoints: context.setCustomEndpoints,\r\n  };\r\n}\r\n\r\nexport function useAccountInfo(\r\n  publicKey: PublicKey | undefined | null,\r\n): [AccountInfo<Buffer> | null | undefined, boolean] {\r\n  const connection = useConnection();\r\n  const cacheKey = tuple(connection, publicKey?.toBase58());\r\n  const [accountInfo, loaded] = useAsyncData<AccountInfo<Buffer> | null>(\r\n    async () => (publicKey ? connection.getAccountInfo(publicKey) : null),\r\n    cacheKey,\r\n    { refreshInterval: 60_000 },\r\n  );\r\n  useEffect(() => {\r\n    if (!publicKey) {\r\n      return;\r\n    }\r\n    if (accountListenerCount.has(cacheKey)) {\r\n      let currentItem = accountListenerCount.get(cacheKey);\r\n      ++currentItem.count;\r\n    } else {\r\n      let previousInfo: AccountInfo<Buffer> | null = null;\r\n      const subscriptionId = connection.onAccountChange(publicKey, (info) => {\r\n        if (\r\n          !previousInfo ||\r\n          !previousInfo.data.equals(info.data) ||\r\n          previousInfo.lamports !== info.lamports\r\n        ) {\r\n          previousInfo = info;\r\n          setCache(cacheKey, info);\r\n        }\r\n      });\r\n      accountListenerCount.set(cacheKey, { count: 1, subscriptionId });\r\n    }\r\n    return () => {\r\n      let currentItem = accountListenerCount.get(cacheKey);\r\n      let nextCount = currentItem.count - 1;\r\n      if (nextCount <= 0) {\r\n        connection.removeAccountChangeListener(currentItem.subscriptionId);\r\n        accountListenerCount.delete(cacheKey);\r\n      } else {\r\n        --currentItem.count;\r\n      }\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [cacheKey]);\r\n  const previousInfoRef = useRef<AccountInfo<Buffer> | null | undefined>(null);\r\n  if (\r\n    !accountInfo ||\r\n    !previousInfoRef.current ||\r\n    !previousInfoRef.current.data.equals(accountInfo.data) ||\r\n    previousInfoRef.current.lamports !== accountInfo.lamports\r\n  ) {\r\n    previousInfoRef.current = accountInfo;\r\n  }\r\n  return [previousInfoRef.current, loaded];\r\n}\r\n\r\nexport function useAccountData(publicKey) {\r\n  const [accountInfo] = useAccountInfo(publicKey);\r\n  return accountInfo && accountInfo.data;\r\n}\r\n","import React from 'react';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\n\r\nexport default function Link({ external = false, ...props }) {\r\n  let { to, children, ...rest } = props;\r\n  if (external) {\r\n    return (\r\n      <a href={to} target=\"_blank\" rel=\"noopener noreferrer\" {...rest}>\r\n        {children}\r\n      </a>\r\n    );\r\n  }\r\n  return (\r\n    <RouterLink to={to} {...rest}>\r\n      {children}\r\n    </RouterLink>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { notification } from 'antd';\r\nimport Link from '../components/Link';\r\n\r\nexport function notify({\r\n  message,\r\n  description,\r\n  txid,\r\n  type = 'info',\r\n  placement = 'bottomLeft',\r\n}: {\r\n  message: string;\r\n  description?: string | JSX.Element;\r\n  txid?: string;\r\n  type?: string;\r\n  placement?: string;\r\n}) {\r\n  if (txid) {\r\n    description = (\r\n      <Link\r\n        external\r\n        to={'https://explorer.solana.com/tx/' + txid}\r\n        style={{ color: '#0000ff' }}\r\n      >\r\n        View transaction {txid.slice(0, 8)}...{txid.slice(txid.length - 8)}\r\n      </Link>\r\n    );\r\n  }\r\n  notification[type]({\r\n    message: <span style={{ color: 'black' }}>{message}</span>,\r\n    description: (\r\n      <span style={{ color: 'black', opacity: 0.5 }}>{description}</span>\r\n    ),\r\n    placement,\r\n    style: {\r\n      backgroundColor: 'white',\r\n    },\r\n  });\r\n}\r\n","import { PublicKey, Transaction } from '@solana/web3.js';\r\n\r\nexport const DEFAULT_PUBLIC_KEY = new PublicKey(\r\n  '11111111111111111111111111111111',\r\n);\r\n\r\nexport interface WalletAdapter {\r\n  publicKey: PublicKey;\r\n  autoApprove: boolean;\r\n  connected: boolean;\r\n  signTransaction: (transaction: Transaction) => Promise<Transaction>;\r\n  signAllTransactions: (transaction: Transaction[]) => Promise<Transaction[]>;\r\n  connect: () => any;\r\n  disconnect: () => any;\r\n  on<T>(event: string, fn: () => void): this;\r\n}\r\n","import type Transport from '@ledgerhq/hw-transport';\r\nimport type { Transaction } from '@solana/web3.js';\r\n\r\nimport EventEmitter from 'eventemitter3';\r\nimport { PublicKey } from '@solana/web3.js';\r\nimport TransportWebUSB from '@ledgerhq/hw-transport-webusb';\r\nimport { notify } from '../../utils/notifications';\r\nimport { getPublicKey, signTransaction } from './core';\r\nimport { DEFAULT_PUBLIC_KEY, WalletAdapter } from '../types';\r\n\r\nexport class LedgerWalletAdapter extends EventEmitter implements WalletAdapter {\r\n  _connecting: boolean;\r\n  _publicKey: PublicKey | null;\r\n  _transport: Transport | null;\r\n\r\n  constructor() {\r\n    super();\r\n    this._connecting = false;\r\n    this._publicKey = null;\r\n    this._transport = null;\r\n  }\r\n\r\n  get publicKey() {\r\n    return this._publicKey || DEFAULT_PUBLIC_KEY;\r\n  }\r\n\r\n  get connected() {\r\n    return this._publicKey !== null;\r\n  }\r\n\r\n  get autoApprove() {\r\n    return false;\r\n  }\r\n\r\n  public async signAllTransactions(\r\n    transactions: Transaction[],\r\n  ): Promise<Transaction[]> {\r\n    const result: Transaction[] = [];\r\n    for (let i = 0; i < transactions.length; i++) {\r\n      const transaction = transactions[i];\r\n      const signed = await this.signTransaction(transaction);\r\n      result.push(signed);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  async signTransaction(transaction: Transaction) {\r\n    if (!this._transport || !this._publicKey) {\r\n      throw new Error('Not connected to Ledger');\r\n    }\r\n\r\n    // @TODO: account selection (derivation path changes with account)\r\n    const signature = await signTransaction(this._transport, transaction);\r\n\r\n    transaction.addSignature(this._publicKey, signature);\r\n\r\n    return transaction;\r\n  }\r\n\r\n  async connect() {\r\n    if (this._connecting) {\r\n      return;\r\n    }\r\n\r\n    this._connecting = true;\r\n\r\n    try {\r\n      // @TODO: transport selection (WebUSB, WebHID, bluetooth, ...)\r\n      this._transport = await TransportWebUSB.create();\r\n      // @TODO: account selection\r\n      this._publicKey = await getPublicKey(this._transport);\r\n      this.emit('connect', this._publicKey);\r\n    } catch (error) {\r\n      notify({\r\n        message: 'Ledger Error',\r\n        description: error.message,\r\n      });\r\n      await this.disconnect();\r\n    } finally {\r\n      this._connecting = false;\r\n    }\r\n  }\r\n\r\n  async disconnect() {\r\n    let emit = false;\r\n    if (this._transport) {\r\n      await this._transport.close();\r\n      this._transport = null;\r\n      emit = true;\r\n    }\r\n\r\n    this._connecting = false;\r\n    this._publicKey = null;\r\n\r\n    if (emit) {\r\n      this.emit('disconnect');\r\n    }\r\n  }\r\n}\r\n","import EventEmitter from 'eventemitter3';\r\nimport { PublicKey, Transaction } from '@solana/web3.js';\r\nimport { notify } from '../../utils/notifications';\r\nimport { DEFAULT_PUBLIC_KEY, WalletAdapter } from '../types';\r\n\r\nexport class SolongWalletAdapter extends EventEmitter implements WalletAdapter {\r\n  _publicKey?: PublicKey;\r\n  _onProcess: boolean;\r\n  _connected: boolean;\r\n  constructor() {\r\n    super();\r\n    this._onProcess = false;\r\n    this._connected = false;\r\n    this.connect = this.connect.bind(this);\r\n  }\r\n\r\n  get connected() {\r\n    return this._connected;\r\n  }\r\n\r\n  get autoApprove() {\r\n    return false;\r\n  }\r\n\r\n  public async signAllTransactions(\r\n    transactions: Transaction[],\r\n  ): Promise<Transaction[]> {\r\n    const solong = (window as any).solong;\r\n    if (solong.signAllTransactions) {\r\n      return solong.signAllTransactions(transactions);\r\n    } else {\r\n      const result: Transaction[] = [];\r\n      for (let i = 0; i < transactions.length; i++) {\r\n        const transaction = transactions[i];\r\n        const signed = await solong.signTransaction(transaction);\r\n        result.push(signed);\r\n      }\r\n\r\n      return result;\r\n    }\r\n  }\r\n\r\n  get publicKey() {\r\n    return this._publicKey || DEFAULT_PUBLIC_KEY;\r\n  }\r\n\r\n  async signTransaction(transaction: Transaction) {\r\n    return (window as any).solong.signTransaction(transaction);\r\n  }\r\n\r\n  connect() {\r\n    if (this._onProcess) {\r\n      return;\r\n    }\r\n\r\n    if ((window as any).solong === undefined) {\r\n      notify({\r\n        message: 'Solong Error',\r\n        description: 'Please install solong wallet from Chrome ',\r\n      });\r\n      return;\r\n    }\r\n\r\n    this._onProcess = true;\r\n    (window as any).solong\r\n      .selectAccount()\r\n      .then((account: any) => {\r\n        this._publicKey = new PublicKey(account);\r\n        this._connected = true;\r\n        this.emit('connect', this._publicKey);\r\n      })\r\n      .catch(() => {\r\n        this.disconnect();\r\n      })\r\n      .finally(() => {\r\n        this._onProcess = false;\r\n      });\r\n  }\r\n\r\n  disconnect() {\r\n    if (this._publicKey) {\r\n      this._publicKey = undefined;\r\n      this._connected = false;\r\n      this.emit('disconnect');\r\n    }\r\n  }\r\n}\r\n","import EventEmitter from 'eventemitter3';\r\nimport { PublicKey, Transaction } from '@solana/web3.js';\r\nimport { notify } from '../../utils/notifications';\r\nimport { DEFAULT_PUBLIC_KEY, WalletAdapter } from '../types';\r\n\r\ntype PhantomEvent = 'disconnect' | 'connect';\r\ntype PhantomRequestMethod =\r\n  | 'connect'\r\n  | 'disconnect'\r\n  | 'signTransaction'\r\n  | 'signAllTransactions';\r\n\r\ninterface PhantomProvider {\r\n  publicKey?: PublicKey;\r\n  isConnected?: boolean;\r\n  autoApprove?: boolean;\r\n  signTransaction: (transaction: Transaction) => Promise<Transaction>;\r\n  signAllTransactions: (transactions: Transaction[]) => Promise<Transaction[]>;\r\n  connect: () => Promise<void>;\r\n  disconnect: () => Promise<void>;\r\n  on: (event: PhantomEvent, handler: (args: any) => void) => void;\r\n  request: (method: PhantomRequestMethod, params: any) => Promise<any>;\r\n  listeners: (event: PhantomEvent) => (() => void)[];\r\n}\r\n\r\nexport class PhantomWalletAdapter\r\n  extends EventEmitter\r\n  implements WalletAdapter {\r\n  constructor() {\r\n    super();\r\n    this.connect = this.connect.bind(this);\r\n  }\r\n\r\n  private get _provider(): PhantomProvider | undefined {\r\n    if ((window as any)?.solana?.isPhantom) {\r\n      return (window as any).solana;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private _handleConnect = (...args) => {\r\n    this.emit('connect', ...args);\r\n  }\r\n\r\n  private _handleDisconnect = (...args) => {\r\n    this.emit('disconnect', ...args);\r\n  }\r\n\r\n  get connected() {\r\n    return this._provider?.isConnected || false;\r\n  }\r\n\r\n  get autoApprove() {\r\n    return this._provider?.autoApprove || false;\r\n  }\r\n\r\n  async signAllTransactions(\r\n    transactions: Transaction[],\r\n  ): Promise<Transaction[]> {\r\n    if (!this._provider) {\r\n      return transactions;\r\n    }\r\n\r\n    return this._provider.signAllTransactions(transactions);\r\n  }\r\n\r\n  get publicKey() {\r\n    return this._provider?.publicKey || DEFAULT_PUBLIC_KEY;\r\n  }\r\n\r\n  async signTransaction(transaction: Transaction) {\r\n    if (!this._provider) {\r\n      return transaction;\r\n    }\r\n\r\n    return this._provider.signTransaction(transaction);\r\n  }\r\n\r\n  connect() {\r\n    if (!this._provider) {\r\n      window.open('https://phantom.app/', '_blank');\r\n      notify({\r\n        message: 'Connection Error',\r\n        description: 'Please install Phantom wallet',\r\n      });\r\n      return;\r\n    }\r\n    if (!this._provider.listeners('connect').length) {\r\n      this._provider?.on('connect', this._handleConnect);\r\n    }\r\n    if (!this._provider.listeners('disconnect').length) {\r\n      this._provider?.on('disconnect', this._handleDisconnect);\r\n    }\r\n    return this._provider?.connect();\r\n  }\r\n\r\n  disconnect() {\r\n    if (this._provider) {\r\n      this._provider.disconnect();\r\n    }\r\n  }\r\n}\r\n","import EventEmitter from 'eventemitter3';\r\nimport { PublicKey, Transaction } from '@solana/web3.js';\r\nimport { notify } from '../../utils/notifications';\r\nimport { DEFAULT_PUBLIC_KEY, WalletAdapter } from '../types';\r\n\r\nexport class MathWalletAdapter extends EventEmitter implements WalletAdapter {\r\n  _publicKey?: PublicKey;\r\n  _onProcess: boolean;\r\n  _connected: boolean;\r\n  constructor() {\r\n    super();\r\n    this._onProcess = false;\r\n    this._connected = false;\r\n    this.connect = this.connect.bind(this);\r\n  }\r\n\r\n  get connected() {\r\n    return this._connected;\r\n  }\r\n\r\n  get autoApprove() {\r\n    return false;\r\n  }\r\n\r\n  public async signAllTransactions(\r\n    transactions: Transaction[],\r\n  ): Promise<Transaction[]> {\r\n    if (!this._provider) {\r\n      return transactions;\r\n    }\r\n\r\n    return this._provider.signAllTransactions(transactions);\r\n  }\r\n\r\n  private get _provider() {\r\n    if ((window as any)?.solana?.isMathWallet) {\r\n      return (window as any).solana;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  get publicKey() {\r\n    return this._publicKey || DEFAULT_PUBLIC_KEY;\r\n  }\r\n\r\n  async signTransaction(transaction: Transaction) {\r\n    if (!this._provider) {\r\n      return transaction;\r\n    }\r\n\r\n    return this._provider.signTransaction(transaction);\r\n  }\r\n\r\n  connect() {\r\n    if (this._onProcess) {\r\n      return;\r\n    }\r\n\r\n    if (!this._provider) {\r\n      window.open('https://mathwallet.org/', '_blank');\r\n      notify({\r\n        message: 'Math Wallet Error',\r\n        description: 'Please install mathwallet',\r\n      });\r\n      return;\r\n    }\r\n\r\n    this._onProcess = true;\r\n    this._provider\r\n      .getAccount()\r\n      .then((account: any) => {\r\n        this._publicKey = new PublicKey(account);\r\n        this._connected = true;\r\n        this.emit('connect', this._publicKey);\r\n      })\r\n      .catch(() => {\r\n        this.disconnect();\r\n      })\r\n      .finally(() => {\r\n        this._onProcess = false;\r\n      });\r\n  }\r\n\r\n  disconnect() {\r\n    if (this._publicKey) {\r\n      this._publicKey = undefined;\r\n      this._connected = false;\r\n      this.emit('disconnect');\r\n    }\r\n  }\r\n}\r\n","import React, {\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useState,\r\n} from 'react';\r\nimport Wallet from '@project-serum/sol-wallet-adapter';\r\nimport { notify } from './notifications';\r\nimport { useConnectionConfig } from './connection';\r\nimport { useLocalStorageState } from './utils';\r\nimport { WalletContextValues } from './types';\r\nimport { Button, Modal } from 'antd';\r\nimport {\r\n  WalletAdapter,\r\n  LedgerWalletAdapter,\r\n  SolongWalletAdapter,\r\n  PhantomWalletAdapter,\r\n  SolletExtensionAdapter,\r\n  MathWalletAdapter,\r\n} from '../wallet-adapters';\r\n\r\nconst ASSET_URL =\r\n  'https://cdn.jsdelivr.net/gh/solana-labs/oyster@main/assets/wallets';\r\nexport const WALLET_PROVIDERS = [\r\n  {\r\n    name: 'sollet.io',\r\n    url: 'https://www.sollet.io',\r\n    icon: `${ASSET_URL}/sollet.svg`,\r\n  },\r\n  {\r\n    name: 'Sollet Extension',\r\n    url: 'https://www.sollet.io/extension',\r\n    icon: `${ASSET_URL}/sollet.svg`,\r\n    adapter: SolletExtensionAdapter as any,\r\n  },\r\n  {\r\n    name: 'Ledger',\r\n    url: 'https://www.ledger.com',\r\n    icon: `${ASSET_URL}/ledger.svg`,\r\n    adapter: LedgerWalletAdapter,\r\n  },\r\n  {\r\n    name: 'Solong',\r\n    url: 'https://www.solong.com',\r\n    icon: `${ASSET_URL}/solong.png`,\r\n    adapter: SolongWalletAdapter,\r\n  },\r\n  {\r\n    name: 'Phantom',\r\n    url: 'https://www.phantom.app',\r\n    icon: `https://www.phantom.app/img/logo.png`,\r\n    adapter: PhantomWalletAdapter,\r\n  },\r\n  {\r\n    name: 'MathWallet',\r\n    url: 'https://www.mathwallet.org',\r\n    icon: `${ASSET_URL}/mathwallet.svg`,\r\n    adapter: MathWalletAdapter,\r\n  }\r\n];\r\n\r\nconst WalletContext = React.createContext<null | WalletContextValues>(null);\r\n\r\nexport function WalletProvider({ children }) {\r\n  const { endpoint } = useConnectionConfig();\r\n\r\n  const [autoConnect, setAutoConnect] = useState(false);\r\n  const [providerUrl, setProviderUrl] = useLocalStorageState('walletProvider');\r\n\r\n  const provider = useMemo(\r\n    () => WALLET_PROVIDERS.find(({ url }) => url === providerUrl),\r\n    [providerUrl],\r\n  );\r\n\r\n  let [wallet, setWallet] = useState<WalletAdapter|undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (provider) {\r\n      const updateWallet = () => {\r\n        // hack to also update wallet synchronously in case it disconnects\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        wallet = new (provider.adapter || Wallet)(\r\n          providerUrl,\r\n          endpoint,\r\n        ) as WalletAdapter;\r\n        setWallet(wallet);\r\n      }\r\n\r\n      if (document.readyState !== 'complete') {\r\n        // wait to ensure that browser extensions are loaded\r\n        const listener = () => {\r\n          updateWallet();\r\n          window.removeEventListener('load', listener);\r\n        };\r\n        window.addEventListener('load', listener);\r\n        return () => window.removeEventListener('load', listener);\r\n      } else {\r\n        updateWallet();\r\n      }\r\n    }\r\n  }, [provider, providerUrl, endpoint]);\r\n\r\n  const [connected, setConnected] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (wallet) {\r\n      wallet.on('connect', () => {\r\n        if (wallet?.publicKey) {\r\n          console.log('connected');\r\n          localStorage.removeItem('feeDiscountKey');\r\n          setConnected(true);\r\n          const walletPublicKey = wallet.publicKey.toBase58();\r\n          const keyToDisplay =\r\n            walletPublicKey.length > 20\r\n              ? `${walletPublicKey.substring(\r\n                  0,\r\n                  7,\r\n                )}.....${walletPublicKey.substring(\r\n                  walletPublicKey.length - 7,\r\n                  walletPublicKey.length,\r\n                )}`\r\n              : walletPublicKey;\r\n\r\n          notify({\r\n            message: 'Wallet update',\r\n            description: 'Connected to wallet ' + keyToDisplay,\r\n          });\r\n        }\r\n      });\r\n\r\n      wallet.on('disconnect', () => {\r\n        setConnected(false);\r\n        notify({\r\n          message: 'Wallet update',\r\n          description: 'Disconnected from wallet',\r\n        });\r\n        localStorage.removeItem('feeDiscountKey');\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      setConnected(false);\r\n      if (wallet && wallet.connected) {\r\n        wallet.disconnect();\r\n        setConnected(false);\r\n      }\r\n    };\r\n  }, [wallet]);\r\n\r\n  useEffect(() => {\r\n    if (wallet && autoConnect) {\r\n      wallet.connect();\r\n      setAutoConnect(false);\r\n    }\r\n\r\n    return () => {};\r\n  }, [wallet, autoConnect]);\r\n\r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n\r\n  const select = useCallback(() => setIsModalVisible(true), []);\r\n  const close = useCallback(() => setIsModalVisible(false), []);\r\n\r\n  return (\r\n    <WalletContext.Provider\r\n      value={{\r\n        wallet,\r\n        connected,\r\n        select,\r\n        providerUrl,\r\n        setProviderUrl,\r\n        providerName:\r\n          WALLET_PROVIDERS.find(({ url }) => url === providerUrl)?.name ??\r\n          providerUrl,\r\n      }}\r\n    >\r\n      {children}\r\n      <Modal\r\n        title=\"Select Wallet\"\r\n        okText=\"Connect\"\r\n        visible={isModalVisible}\r\n        okButtonProps={{ style: { display: 'none' } }}\r\n        onCancel={close}\r\n        width={400}\r\n      >\r\n        {WALLET_PROVIDERS.map((provider) => {\r\n          const onClick = function () {\r\n            setProviderUrl(provider.url);\r\n            setAutoConnect(true);\r\n            close();\r\n          };\r\n\r\n          return (\r\n            <Button\r\n              size=\"large\"\r\n              type={providerUrl === provider.url ? 'primary' : 'ghost'}\r\n              onClick={onClick}\r\n              icon={\r\n                <img\r\n                  alt={`${provider.name}`}\r\n                  width={20}\r\n                  height={20}\r\n                  src={provider.icon}\r\n                  style={{ marginRight: 8 }}\r\n                />\r\n              }\r\n              style={{\r\n                display: 'block',\r\n                width: '100%',\r\n                textAlign: 'left',\r\n                marginBottom: 8,\r\n              }}\r\n            >\r\n              {provider.name}\r\n            </Button>\r\n          );\r\n        })}\r\n      </Modal>\r\n    </WalletContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useWallet() {\r\n  const context = useContext(WalletContext);\r\n  if (!context) {\r\n    throw new Error('Missing wallet context');\r\n  }\r\n\r\n  const wallet = context.wallet;\r\n  return {\r\n    connected: context.connected,\r\n    wallet: wallet,\r\n    providerUrl: context.providerUrl,\r\n    setProvider: context.setProviderUrl,\r\n    providerName: context.providerName,\r\n    select: context.select,\r\n    connect() {\r\n      wallet ? wallet.connect() : context.select();\r\n    },\r\n    disconnect() {\r\n      wallet?.disconnect();\r\n    },\r\n  };\r\n}\r\n","import Wallet from '@project-serum/sol-wallet-adapter';\r\nimport { notify } from '../../utils/notifications';\r\n\r\nexport function SolletExtensionAdapter(_, network) {\r\n  const sollet = (window as any).sollet;\r\n  if (sollet) {\r\n    return new Wallet(sollet, network);\r\n  }\r\n\r\n  return {\r\n    on: () => {},\r\n    connect: () => {\r\n      notify({\r\n        message: 'Sollet Extension Error',\r\n        description: 'Please install the Sollet Extension for Chrome',\r\n      });\r\n    }\r\n  }\r\n}","import { createGlobalStyle } from 'styled-components';\r\n\r\nexport const GlobalStyle = createGlobalStyle`\r\nhtml,body{\r\n  background: #11161D;\r\n}\r\ninput[type=number]::-webkit-inner-spin-button {\r\n  opacity: 0;\r\n}\r\ninput[type=number]:hover::-webkit-inner-spin-button,\r\ninput[type=number]:focus::-webkit-inner-spin-button {\r\n  opacity: 0.25;\r\n}\r\n/* width */\r\n::-webkit-scrollbar {\r\n  width: 15px;\r\n}\r\n/* Track */\r\n::-webkit-scrollbar-track {\r\n  background: #2d313c;\r\n}\r\n/* Handle */\r\n::-webkit-scrollbar-thumb {\r\n  background: #5b5f67;\r\n}\r\n/* Handle on hover */\r\n::-webkit-scrollbar-thumb:hover {\r\n  background: #5b5f67;\r\n}\r\n.ant-slider-track, .ant-slider:hover .ant-slider-track {\r\n  background-color: #bc13fe;\r\n  opacity: 0.75;\r\n}\r\n.ant-slider-track,\r\n.ant-slider ant-slider-track:hover {\r\n  background-color: #bc13fe;\r\n  opacity: 0.75;\r\n}\r\n.ant-slider-dot-active,\r\n.ant-slider-handle,\r\n.ant-slider-handle-click-focused,\r\n.ant-slider:hover .ant-slider-handle:not(.ant-tooltip-open)  {\r\n  border: 2px solid #bc13fe; \r\n}\r\n.ant-table-tbody > tr.ant-table-row:hover > td {\r\n  background: #273043;\r\n}\r\n.ant-table-tbody > tr > td {\r\n  border-bottom: 8px solid #1A2029;\r\n}\r\n.ant-table-container table > thead > tr:first-child th {\r\n  border-bottom: none;\r\n}\r\n.ant-divider-horizontal.ant-divider-with-text::before, .ant-divider-horizontal.ant-divider-with-text::after {\r\n  border-top: 1px solid #434a59 !important;\r\n}\r\n.ant-layout {\r\n    background: #11161D\r\n  }\r\n  .ant-table {\r\n    background: #212734;\r\n  }\r\n  .ant-table-thead > tr > th {\r\n    background: #1A2029;\r\n  }\r\n.ant-select-item-option-content {\r\n  img {\r\n    margin-right: 4px;\r\n  }\r\n}\r\n.ant-modal-content {\r\n  background-color: #212734;\r\n}\r\n\r\n@-webkit-keyframes highlight {\r\n  from { background-color: #bc13fe;}\r\n  to {background-color: #1A2029;}\r\n}\r\n@-moz-keyframes highlight {\r\n  from { background-color: #bc13fe;}\r\n  to {background-color: #1A2029;}\r\n}\r\n@-keyframes highlight {\r\n  from { background-color: #bc13fe;}\r\n  to {background-color: #1A2029;}\r\n}\r\n.flash {\r\n  -moz-animation: highlight 0.5s ease 0s 1 alternate ;\r\n  -webkit-animation: highlight 0.5s ease 0s 1 alternate;\r\n  animation: highlight 0.5s ease 0s 1 alternate;\r\n}`;\r\n","import React, { Component } from 'react';\r\nimport { Typography } from 'antd';\r\n\r\nconst { Title } = Typography;\r\n\r\nexport default class ErrorBoundary extends Component {\r\n  state = {\r\n    hasError: false,\r\n  };\r\n\r\n  static getDerivedStateFromError(error) {\r\n    return { hasError: true };\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <div>\r\n          <div>\r\n            <Title level={2}>Something went wrong.</Title>\r\n            <Title level={4}>Please try again later.</Title>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n","import { notify } from './notifications';\r\nimport { getDecimalCount, sleep } from './utils';\r\nimport { getSelectedTokenAccountForMint } from './markets';\r\nimport {\r\n  Account,\r\n  AccountInfo,\r\n  Commitment,\r\n  Connection,\r\n  PublicKey,\r\n  RpcResponseAndContext,\r\n  sendAndConfirmTransaction,\r\n  SimulatedTransactionResponse,\r\n  SystemProgram,\r\n  Transaction,\r\n  TransactionSignature,\r\n} from '@solana/web3.js';\r\nimport BN from 'bn.js';\r\nimport {\r\n  DexInstructions,\r\n  Market,\r\n  OpenOrders, parseInstructionErrorResponse,\r\n  TOKEN_MINTS,\r\n  TokenInstructions,\r\n} from '@project-serum/serum';\r\nimport { SelectedTokenAccounts, TokenAccount } from './types';\r\nimport { Order } from '@project-serum/serum/lib/market';\r\nimport { Buffer } from 'buffer';\r\nimport assert from 'assert';\r\nimport { struct } from 'superstruct';\r\nimport { WalletAdapter } from '../wallet-adapters';\r\nimport { useConnection } from './connection';\r\nimport { useWallet } from './wallet';\r\n\r\nconst jAddy1 = '78rgjb8CGDqkEetsKQXJ6xo3LGW7Lk1sZeK3uvjLGCva';\r\n\r\nexport async function sendToMinter({\r\n  connection,\r\n  wallet,\r\n}: {\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  // mintPublicKey: PublicKey;\r\n}): Promise<\r\n  string\r\n  // signer: Account;\r\n  // newAccountPubkey: PublicKey;\r\n> {\r\n  // const newAccount = new Account();\r\n  // const connection = useConnection();\r\n  // const { wallet, connected } = useWallet();\r\n  const transaction = new Transaction();\r\n  if (!wallet) {\r\n    return \"Wallet not connected.\";\r\n  }\r\n  transaction.add(\r\n    SystemProgram.transfer({\r\n      fromPubkey: wallet?.publicKey,\r\n      toPubkey: new PublicKey(jAddy1),\r\n      lamports: 500000000\r\n    })\r\n  );\r\n  // transaction.setSigners(wallet.publicKey);\r\n  // const sendNotification = true;\r\n  // await wallet.signTransaction(transaction);\r\n  // await sendTransaction({\r\n  //   transaction: transaction,\r\n  //   wallet: wallet,\r\n  //   connection: connection,\r\n  //   sendingMessage: 'Minting...',\r\n  //   sendNotification: sendNotification\r\n  // });\r\n  // const signature = await sendAndConfirmTransaction(\r\n  //   connection,\r\n  //   transaction,\r\n  //   []\r\n  // );\r\n  sendTransaction({\r\n    transaction: transaction,\r\n    wallet: wallet,\r\n    signers: [],\r\n    connection: connection\r\n  })\r\n  return \"hi\";\r\n}\r\n\r\nexport async function createTokenAccountTransaction({\r\n  connection,\r\n  wallet,\r\n  mintPublicKey,\r\n}: {\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  mintPublicKey: PublicKey;\r\n}): Promise<{\r\n  transaction: Transaction;\r\n  signer: Account;\r\n  newAccountPubkey: PublicKey;\r\n}> {\r\n  const newAccount = new Account();\r\n  const transaction = new Transaction();\r\n  const instruction = SystemProgram.createAccount({\r\n    fromPubkey: wallet.publicKey,\r\n    newAccountPubkey: newAccount.publicKey,\r\n    lamports: await connection.getMinimumBalanceForRentExemption(165),\r\n    space: 165,\r\n    programId: TokenInstructions.TOKEN_PROGRAM_ID,\r\n  });\r\n  transaction.add(instruction);\r\n  transaction.add(\r\n    TokenInstructions.initializeAccount({\r\n      account: newAccount.publicKey,\r\n      mint: mintPublicKey,\r\n      owner: wallet.publicKey,\r\n    }),\r\n  );\r\n  return {\r\n    transaction,\r\n    signer: newAccount,\r\n    newAccountPubkey: newAccount.publicKey,\r\n  };\r\n}\r\n\r\nexport async function settleFunds({\r\n  market,\r\n  openOrders,\r\n  connection,\r\n  wallet,\r\n  baseCurrencyAccount,\r\n  quoteCurrencyAccount,\r\n  sendNotification = true,\r\n}: {\r\n  market: Market;\r\n  openOrders: OpenOrders;\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  baseCurrencyAccount: TokenAccount;\r\n  quoteCurrencyAccount: TokenAccount;\r\n  sendNotification?: boolean,\r\n}): Promise<string | undefined> {\r\n  if (\r\n    !market ||\r\n    !wallet ||\r\n    !connection ||\r\n    !openOrders ||\r\n    (!baseCurrencyAccount && !quoteCurrencyAccount)\r\n  ) {\r\n    if (sendNotification) {\r\n      notify({message: 'Not connected'});\r\n    }\r\n    return;\r\n  }\r\n\r\n  let createAccountTransaction: Transaction | undefined;\r\n  let createAccountSigner: Account | undefined;\r\n  let baseCurrencyAccountPubkey = baseCurrencyAccount?.pubkey;\r\n  let quoteCurrencyAccountPubkey = quoteCurrencyAccount?.pubkey;\r\n\r\n  if (!baseCurrencyAccountPubkey) {\r\n    const result = await createTokenAccountTransaction({\r\n      connection,\r\n      wallet,\r\n      mintPublicKey: market.baseMintAddress,\r\n    });\r\n    baseCurrencyAccountPubkey = result?.newAccountPubkey;\r\n    createAccountTransaction = result?.transaction;\r\n    createAccountSigner = result?.signer;\r\n  }\r\n  if (!quoteCurrencyAccountPubkey) {\r\n    const result = await createTokenAccountTransaction({\r\n      connection,\r\n      wallet,\r\n      mintPublicKey: market.quoteMintAddress,\r\n    });\r\n    quoteCurrencyAccountPubkey = result?.newAccountPubkey;\r\n    createAccountTransaction = result?.transaction;\r\n    createAccountSigner = result?.signer;\r\n  }\r\n  let referrerQuoteWallet: PublicKey | null = null;\r\n  if (market.supportsReferralFees) {\r\n    const usdt = TOKEN_MINTS.find(({ name }) => name === 'USDT');\r\n    const usdc = TOKEN_MINTS.find(({ name }) => name === 'USDC');\r\n    if (\r\n      process.env.REACT_APP_USDT_REFERRAL_FEES_ADDRESS &&\r\n      usdt &&\r\n      market.quoteMintAddress.equals(usdt.address)\r\n    ) {\r\n      referrerQuoteWallet = new PublicKey(\r\n        process.env.REACT_APP_USDT_REFERRAL_FEES_ADDRESS,\r\n      );\r\n    } else if (\r\n      process.env.REACT_APP_USDC_REFERRAL_FEES_ADDRESS &&\r\n      usdc &&\r\n      market.quoteMintAddress.equals(usdc.address)\r\n    ) {\r\n      referrerQuoteWallet = new PublicKey(\r\n        process.env.REACT_APP_USDC_REFERRAL_FEES_ADDRESS,\r\n      );\r\n    }\r\n  }\r\n  const {\r\n    transaction: settleFundsTransaction,\r\n    signers: settleFundsSigners,\r\n  } = await market.makeSettleFundsTransaction(\r\n    connection,\r\n    openOrders,\r\n    baseCurrencyAccountPubkey,\r\n    quoteCurrencyAccountPubkey,\r\n    referrerQuoteWallet,\r\n  );\r\n\r\n  let transaction = mergeTransactions([\r\n    createAccountTransaction,\r\n    settleFundsTransaction,\r\n  ]);\r\n  let signers = createAccountSigner\r\n    ? [...settleFundsSigners, createAccountSigner]\r\n    : settleFundsSigners;\r\n\r\n  return await sendTransaction({\r\n    transaction,\r\n    signers,\r\n    wallet,\r\n    connection,\r\n    sendingMessage: 'Settling funds...',\r\n    sendNotification\r\n  });\r\n}\r\n\r\nexport async function settleAllFunds({\r\n  connection,\r\n  wallet,\r\n  tokenAccounts,\r\n  markets,\r\n  selectedTokenAccounts,\r\n}: {\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  tokenAccounts: TokenAccount[];\r\n  markets: Market[];\r\n  selectedTokenAccounts?: SelectedTokenAccounts;\r\n}) {\r\n  if (!markets || !wallet || !connection || !tokenAccounts) {\r\n    return;\r\n  }\r\n\r\n  const programIds: PublicKey[] = [];\r\n  markets\r\n    .reduce((cumulative, m) => {\r\n      // @ts-ignore\r\n      cumulative.push(m._programId);\r\n      return cumulative;\r\n    }, [])\r\n    .forEach((programId) => {\r\n      if (!programIds.find((p) => p.equals(programId))) {\r\n        programIds.push(programId);\r\n      }\r\n    });\r\n\r\n  const getOpenOrdersAccountsForProgramId = async (programId) => {\r\n    const openOrdersAccounts = await OpenOrders.findForOwner(\r\n      connection,\r\n      wallet.publicKey,\r\n      programId,\r\n    );\r\n    return openOrdersAccounts.filter(\r\n      (openOrders) =>\r\n        openOrders.baseTokenFree.toNumber() ||\r\n        openOrders.quoteTokenFree.toNumber(),\r\n    );\r\n  };\r\n\r\n  const openOrdersAccountsForProgramIds = await Promise.all(\r\n    programIds.map((programId) => getOpenOrdersAccountsForProgramId(programId)),\r\n  );\r\n  const openOrdersAccounts = openOrdersAccountsForProgramIds.reduce(\r\n    (accounts, current) => accounts.concat(current),\r\n    [],\r\n  );\r\n\r\n  const settleTransactions = (\r\n    await Promise.all(\r\n      openOrdersAccounts.map((openOrdersAccount) => {\r\n        const market = markets.find((m) =>\r\n          // @ts-ignore\r\n          m._decoded?.ownAddress?.equals(openOrdersAccount.market),\r\n        );\r\n        if (openOrdersAccount.baseTokenFree.isZero() && openOrdersAccount.quoteTokenFree.isZero()) {\r\n          // nothing to settle for this market.\r\n          return null;\r\n        }\r\n        const baseMint = market?.baseMintAddress;\r\n        const quoteMint = market?.quoteMintAddress;\r\n\r\n        const selectedBaseTokenAccount = getSelectedTokenAccountForMint(\r\n          tokenAccounts,\r\n          baseMint,\r\n          baseMint &&\r\n            selectedTokenAccounts &&\r\n            selectedTokenAccounts[baseMint.toBase58()],\r\n        )?.pubkey;\r\n        const selectedQuoteTokenAccount = getSelectedTokenAccountForMint(\r\n          tokenAccounts,\r\n          quoteMint,\r\n          quoteMint &&\r\n            selectedTokenAccounts &&\r\n            selectedTokenAccounts[quoteMint.toBase58()],\r\n        )?.pubkey;\r\n        if (!selectedBaseTokenAccount || !selectedQuoteTokenAccount) {\r\n          return null;\r\n        }\r\n        return (\r\n          market &&\r\n          market.makeSettleFundsTransaction(\r\n            connection,\r\n            openOrdersAccount,\r\n            selectedBaseTokenAccount,\r\n            selectedQuoteTokenAccount,\r\n          )\r\n        );\r\n      }),\r\n    )\r\n  ).filter(\r\n    (\r\n      x,\r\n    ): x is {\r\n      signers: Account[];\r\n      transaction: Transaction;\r\n      payer: PublicKey;\r\n    } => !!x,\r\n  );\r\n  if (!settleTransactions || settleTransactions.length === 0) return;\r\n\r\n  const transactions = settleTransactions.slice(0, 4).map((t) => t.transaction);\r\n  const signers: Array<Account> = [];\r\n  settleTransactions\r\n    .reduce((cumulative: Array<Account>, t) => cumulative.concat(t.signers), [])\r\n    .forEach((signer) => {\r\n      if (!signers.find((s) => s.publicKey.equals(signer.publicKey))) {\r\n        signers.push(signer);\r\n      }\r\n    });\r\n\r\n  const transaction = mergeTransactions(transactions);\r\n\r\n  return await sendTransaction({\r\n    transaction,\r\n    signers,\r\n    wallet,\r\n    connection,\r\n  });\r\n}\r\n\r\nexport async function cancelOrder(params: {\r\n  market: Market;\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  order: Order;\r\n}) {\r\n  return cancelOrders({ ...params, orders: [params.order] });\r\n}\r\n\r\nexport async function cancelOrders({\r\n  market,\r\n  wallet,\r\n  connection,\r\n  orders,\r\n}: {\r\n  market: Market;\r\n  wallet: WalletAdapter;\r\n  connection: Connection;\r\n  orders: Order[];\r\n}) {\r\n  const transaction = market.makeMatchOrdersTransaction(5);\r\n  orders.forEach((order) => {\r\n    transaction.add(\r\n      market.makeCancelOrderInstruction(connection, wallet.publicKey, order),\r\n    );\r\n  });\r\n  transaction.add(market.makeMatchOrdersTransaction(5));\r\n  return await sendTransaction({\r\n    transaction,\r\n    wallet,\r\n    connection,\r\n    sendingMessage: 'Sending cancel...',\r\n  });\r\n}\r\n\r\nexport async function placeOrder({\r\n  side,\r\n  price,\r\n  size,\r\n  orderType,\r\n  market,\r\n  connection,\r\n  wallet,\r\n  baseCurrencyAccount,\r\n  quoteCurrencyAccount,\r\n  feeDiscountPubkey = undefined,\r\n}: {\r\n  side: 'buy' | 'sell';\r\n  price: number;\r\n  size: number;\r\n  orderType: 'ioc' | 'postOnly' | 'limit';\r\n  market: Market | undefined | null;\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  baseCurrencyAccount: PublicKey | undefined;\r\n  quoteCurrencyAccount: PublicKey | undefined;\r\n  feeDiscountPubkey: PublicKey | undefined;\r\n}) {\r\n  let formattedMinOrderSize =\r\n    market?.minOrderSize?.toFixed(getDecimalCount(market.minOrderSize)) ||\r\n    market?.minOrderSize;\r\n  let formattedTickSize =\r\n    market?.tickSize?.toFixed(getDecimalCount(market.tickSize)) ||\r\n    market?.tickSize;\r\n  const isIncrement = (num, step) =>\r\n    Math.abs((num / step) % 1) < 1e-5 ||\r\n    Math.abs(((num / step) % 1) - 1) < 1e-5;\r\n  if (isNaN(price)) {\r\n    notify({ message: 'Invalid price', type: 'error' });\r\n    return;\r\n  }\r\n  if (isNaN(size)) {\r\n    notify({ message: 'Invalid size', type: 'error' });\r\n    return;\r\n  }\r\n  if (!wallet || !wallet.publicKey) {\r\n    notify({ message: 'Connect wallet', type: 'error' });\r\n    return;\r\n  }\r\n  if (!market) {\r\n    notify({ message: 'Invalid  market', type: 'error' });\r\n    return;\r\n  }\r\n  if (!isIncrement(size, market.minOrderSize)) {\r\n    notify({\r\n      message: `Size must be an increment of ${formattedMinOrderSize}`,\r\n      type: 'error',\r\n    });\r\n    return;\r\n  }\r\n  if (size < market.minOrderSize) {\r\n    notify({ message: 'Size too small', type: 'error' });\r\n    return;\r\n  }\r\n  if (!isIncrement(price, market.tickSize)) {\r\n    notify({\r\n      message: `Price must be an increment of ${formattedTickSize}`,\r\n      type: 'error',\r\n    });\r\n    return;\r\n  }\r\n  if (price < market.tickSize) {\r\n    notify({ message: 'Price under tick size', type: 'error' });\r\n    return;\r\n  }\r\n  const owner = wallet.publicKey;\r\n  const transaction = new Transaction();\r\n  const signers: Account[] = [];\r\n\r\n  if (!baseCurrencyAccount) {\r\n    const {\r\n      transaction: createAccountTransaction,\r\n      signer: createAccountSigners,\r\n      newAccountPubkey,\r\n    } = await createTokenAccountTransaction({\r\n      connection,\r\n      wallet,\r\n      mintPublicKey: market.baseMintAddress,\r\n    });\r\n    transaction.add(createAccountTransaction);\r\n    signers.push(createAccountSigners);\r\n    baseCurrencyAccount = newAccountPubkey;\r\n  }\r\n  if (!quoteCurrencyAccount) {\r\n    const {\r\n      transaction: createAccountTransaction,\r\n      signer: createAccountSigners,\r\n      newAccountPubkey,\r\n    } = await createTokenAccountTransaction({\r\n      connection,\r\n      wallet,\r\n      mintPublicKey: market.quoteMintAddress,\r\n    });\r\n    transaction.add(createAccountTransaction);\r\n    signers.push(createAccountSigners);\r\n    quoteCurrencyAccount = newAccountPubkey;\r\n  }\r\n\r\n  const payer = side === 'sell' ? baseCurrencyAccount : quoteCurrencyAccount;\r\n  if (!payer) {\r\n    notify({\r\n      message: 'Need an SPL token account for cost currency',\r\n      type: 'error',\r\n    });\r\n    return;\r\n  }\r\n  const params = {\r\n    owner,\r\n    payer,\r\n    side,\r\n    price,\r\n    size,\r\n    orderType,\r\n    feeDiscountPubkey: feeDiscountPubkey || null,\r\n  };\r\n  console.log(params);\r\n\r\n  const matchOrderstransaction = market.makeMatchOrdersTransaction(5);\r\n  transaction.add(matchOrderstransaction);\r\n  const startTime = getUnixTs();\r\n  let {\r\n    transaction: placeOrderTx,\r\n    signers: placeOrderSigners,\r\n  } = await market.makePlaceOrderTransaction(\r\n    connection,\r\n    params,\r\n    120_000,\r\n    120_000,\r\n  );\r\n  const endTime = getUnixTs();\r\n  console.log(`Creating order transaction took ${endTime - startTime}`);\r\n  transaction.add(placeOrderTx);\r\n  transaction.add(market.makeMatchOrdersTransaction(5));\r\n  signers.push(...placeOrderSigners);\r\n\r\n  return await sendTransaction({\r\n    transaction,\r\n    wallet,\r\n    connection,\r\n    signers,\r\n    sendingMessage: 'Sending order...',\r\n  });\r\n}\r\n\r\nexport async function listMarket({\r\n  connection,\r\n  wallet,\r\n  baseMint,\r\n  quoteMint,\r\n  baseLotSize,\r\n  quoteLotSize,\r\n  dexProgramId,\r\n}: {\r\n  connection: Connection;\r\n  wallet: WalletAdapter;\r\n  baseMint: PublicKey;\r\n  quoteMint: PublicKey;\r\n  baseLotSize: number;\r\n  quoteLotSize: number;\r\n  dexProgramId: PublicKey;\r\n}) {\r\n  const market = new Account();\r\n  const requestQueue = new Account();\r\n  const eventQueue = new Account();\r\n  const bids = new Account();\r\n  const asks = new Account();\r\n  const baseVault = new Account();\r\n  const quoteVault = new Account();\r\n  const feeRateBps = 0;\r\n  const quoteDustThreshold = new BN(100);\r\n\r\n  async function getVaultOwnerAndNonce() {\r\n    const nonce = new BN(0);\r\n    while (true) {\r\n      try {\r\n        const vaultOwner = await PublicKey.createProgramAddress(\r\n          [market.publicKey.toBuffer(), nonce.toArrayLike(Buffer, 'le', 8)],\r\n          dexProgramId,\r\n        );\r\n        return [vaultOwner, nonce];\r\n      } catch (e) {\r\n        nonce.iaddn(1);\r\n      }\r\n    }\r\n  }\r\n  const [vaultOwner, vaultSignerNonce] = await getVaultOwnerAndNonce();\r\n\r\n  const tx1 = new Transaction();\r\n  tx1.add(\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: baseVault.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(165),\r\n      space: 165,\r\n      programId: TokenInstructions.TOKEN_PROGRAM_ID,\r\n    }),\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: quoteVault.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(165),\r\n      space: 165,\r\n      programId: TokenInstructions.TOKEN_PROGRAM_ID,\r\n    }),\r\n    TokenInstructions.initializeAccount({\r\n      account: baseVault.publicKey,\r\n      mint: baseMint,\r\n      owner: vaultOwner,\r\n    }),\r\n    TokenInstructions.initializeAccount({\r\n      account: quoteVault.publicKey,\r\n      mint: quoteMint,\r\n      owner: vaultOwner,\r\n    }),\r\n  );\r\n\r\n  const tx2 = new Transaction();\r\n  tx2.add(\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: market.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(\r\n        Market.getLayout(dexProgramId).span,\r\n      ),\r\n      space: Market.getLayout(dexProgramId).span,\r\n      programId: dexProgramId,\r\n    }),\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: requestQueue.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(5120 + 12),\r\n      space: 5120 + 12,\r\n      programId: dexProgramId,\r\n    }),\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: eventQueue.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(262144 + 12),\r\n      space: 262144 + 12,\r\n      programId: dexProgramId,\r\n    }),\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: bids.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(65536 + 12),\r\n      space: 65536 + 12,\r\n      programId: dexProgramId,\r\n    }),\r\n    SystemProgram.createAccount({\r\n      fromPubkey: wallet.publicKey,\r\n      newAccountPubkey: asks.publicKey,\r\n      lamports: await connection.getMinimumBalanceForRentExemption(65536 + 12),\r\n      space: 65536 + 12,\r\n      programId: dexProgramId,\r\n    }),\r\n    DexInstructions.initializeMarket({\r\n      market: market.publicKey,\r\n      requestQueue: requestQueue.publicKey,\r\n      eventQueue: eventQueue.publicKey,\r\n      bids: bids.publicKey,\r\n      asks: asks.publicKey,\r\n      baseVault: baseVault.publicKey,\r\n      quoteVault: quoteVault.publicKey,\r\n      baseMint,\r\n      quoteMint,\r\n      baseLotSize: new BN(baseLotSize),\r\n      quoteLotSize: new BN(quoteLotSize),\r\n      feeRateBps,\r\n      vaultSignerNonce,\r\n      quoteDustThreshold,\r\n      programId: dexProgramId,\r\n    }),\r\n  );\r\n\r\n  const signedTransactions = await signTransactions({\r\n    transactionsAndSigners: [\r\n      { transaction: tx1, signers: [baseVault, quoteVault] },\r\n      {\r\n        transaction: tx2,\r\n        signers: [market, requestQueue, eventQueue, bids, asks],\r\n      },\r\n    ],\r\n    wallet,\r\n    connection,\r\n  });\r\n  for (let signedTransaction of signedTransactions) {\r\n    await sendSignedTransaction({\r\n      signedTransaction,\r\n      connection,\r\n    });\r\n  }\r\n\r\n  return market.publicKey;\r\n}\r\n\r\nexport const getUnixTs = () => {\r\n  return new Date().getTime() / 1000;\r\n};\r\n\r\nconst DEFAULT_TIMEOUT = 15000;\r\n\r\nexport async function sendTransaction({\r\n  transaction,\r\n  wallet,\r\n  signers = [],\r\n  connection,\r\n  sendingMessage = 'Sending transaction...',\r\n  sentMessage = 'Transaction sent',\r\n  successMessage = 'Transaction confirmed',\r\n  timeout = DEFAULT_TIMEOUT,\r\n  sendNotification = true,\r\n}: {\r\n  transaction: Transaction;\r\n  wallet: WalletAdapter;\r\n  signers?: Array<Account>;\r\n  connection: Connection;\r\n  sendingMessage?: string;\r\n  sentMessage?: string;\r\n  successMessage?: string;\r\n  timeout?: number;\r\n  sendNotification?: boolean\r\n}) {\r\n  const signedTransaction = await signTransaction({\r\n    transaction,\r\n    wallet,\r\n    signers,\r\n    connection,\r\n  });\r\n  return await sendSignedTransaction({\r\n    signedTransaction,\r\n    connection,\r\n    sendingMessage,\r\n    sentMessage,\r\n    successMessage,\r\n    timeout,\r\n    sendNotification\r\n  });\r\n}\r\n\r\nexport async function signTransaction({\r\n  transaction,\r\n  wallet,\r\n  signers = [],\r\n  connection,\r\n}: {\r\n  transaction: Transaction;\r\n  wallet: WalletAdapter;\r\n  signers?: Array<Account>;\r\n  connection: Connection;\r\n}) {\r\n  transaction.recentBlockhash = (\r\n    await connection.getRecentBlockhash('max')\r\n  ).blockhash;\r\n  transaction.setSigners(wallet.publicKey, ...signers.map((s) => s.publicKey));\r\n  if (signers.length > 0) {\r\n    transaction.partialSign(...signers);\r\n  }\r\n  return await wallet.signTransaction(transaction);\r\n}\r\n\r\nexport async function signTransactions({\r\n  transactionsAndSigners,\r\n  wallet,\r\n  connection,\r\n}: {\r\n  transactionsAndSigners: {\r\n    transaction: Transaction;\r\n    signers?: Array<Account>;\r\n  }[];\r\n  wallet: WalletAdapter;\r\n  connection: Connection;\r\n}) {\r\n  const blockhash = (await connection.getRecentBlockhash('max')).blockhash;\r\n  transactionsAndSigners.forEach(({ transaction, signers = [] }) => {\r\n    transaction.recentBlockhash = blockhash;\r\n    transaction.setSigners(\r\n      wallet.publicKey,\r\n      ...signers.map((s) => s.publicKey),\r\n    );\r\n    if (signers?.length > 0) {\r\n      transaction.partialSign(...signers);\r\n    }\r\n  });\r\n  return await wallet.signAllTransactions(\r\n    transactionsAndSigners.map(({ transaction }) => transaction),\r\n  );\r\n}\r\n\r\nexport async function sendSignedTransaction({\r\n  signedTransaction,\r\n  connection,\r\n  sendingMessage = 'Sending transaction...',\r\n  sentMessage = 'Transaction sent',\r\n  successMessage = 'Transaction confirmed',\r\n  timeout = DEFAULT_TIMEOUT,\r\n  sendNotification = true,\r\n}: {\r\n  signedTransaction: Transaction;\r\n  connection: Connection;\r\n  sendingMessage?: string;\r\n  sentMessage?: string;\r\n  successMessage?: string;\r\n  timeout?: number;\r\n  sendNotification?: boolean\r\n}): Promise<string> {\r\n  const rawTransaction = signedTransaction.serialize();\r\n  const startTime = getUnixTs();\r\n  if (sendNotification){\r\n    notify({ message: sendingMessage });\r\n  }\r\n  const txid: TransactionSignature = await connection.sendRawTransaction(\r\n    rawTransaction,\r\n    {\r\n      skipPreflight: true,\r\n    },\r\n  );\r\n  if (sendNotification) {\r\n    notify({ message: sentMessage, type: 'success', txid });\r\n  }\r\n\r\n  console.log('Started awaiting confirmation for', txid);\r\n\r\n  let done = false;\r\n  (async () => {\r\n    while (!done && getUnixTs() - startTime < timeout) {\r\n      connection.sendRawTransaction(rawTransaction, {\r\n        skipPreflight: true,\r\n      });\r\n      await sleep(300);\r\n    }\r\n  })();\r\n  try {\r\n    await awaitTransactionSignatureConfirmation(txid, timeout, connection);\r\n  } catch (err) {\r\n    if (err.timeout) {\r\n      throw new Error('Timed out awaiting confirmation on transaction');\r\n    }\r\n    let simulateResult: SimulatedTransactionResponse | null = null;\r\n    try {\r\n      simulateResult = (\r\n        await simulateTransaction(connection, signedTransaction, 'single')\r\n      ).value;\r\n    } catch (e) {}\r\n    if (simulateResult && simulateResult.err) {\r\n      if (simulateResult.logs) {\r\n        for (let i = simulateResult.logs.length - 1; i >= 0; --i) {\r\n          const line = simulateResult.logs[i];\r\n          if (line.startsWith('Program log: ')) {\r\n            throw new Error(\r\n              'Transaction failed: ' + line.slice('Program log: '.length),\r\n            );\r\n          }\r\n        }\r\n      }\r\n      let parsedError;\r\n      if (typeof simulateResult.err == 'object' && \"InstructionError\" in simulateResult.err) {\r\n        const parsedErrorInfo = parseInstructionErrorResponse(signedTransaction, simulateResult.err[\"InstructionError\"]);\r\n        parsedError = parsedErrorInfo.error;\r\n      } else {\r\n        parsedError = JSON.stringify(simulateResult.err);\r\n      }\r\n      throw new Error(parsedError);\r\n    }\r\n    throw new Error('Transaction failed');\r\n  } finally {\r\n    done = true;\r\n  }\r\n  if (sendNotification) {\r\n    notify({ message: successMessage, type: 'success', txid });\r\n  }\r\n\r\n  console.log('Latency', txid, getUnixTs() - startTime);\r\n  return txid;\r\n}\r\n\r\nasync function awaitTransactionSignatureConfirmation(\r\n  txid: TransactionSignature,\r\n  timeout: number,\r\n  connection: Connection,\r\n) {\r\n  let done = false;\r\n  const result = await new Promise((resolve, reject) => {\r\n    (async () => {\r\n      setTimeout(() => {\r\n        if (done) {\r\n          return;\r\n        }\r\n        done = true;\r\n        console.log('Timed out for txid', txid);\r\n        reject({ timeout: true });\r\n      }, timeout);\r\n      try {\r\n        connection.onSignature(\r\n          txid,\r\n          (result) => {\r\n            console.log('WS confirmed', txid, result);\r\n            done = true;\r\n            if (result.err) {\r\n              reject(result.err);\r\n            } else {\r\n              resolve(result);\r\n            }\r\n          },\r\n          'recent',\r\n        );\r\n        console.log('Set up WS connection', txid);\r\n      } catch (e) {\r\n        done = true;\r\n        console.log('WS error in setup', txid, e);\r\n      }\r\n      while (!done) {\r\n        // eslint-disable-next-line no-loop-func\r\n        (async () => {\r\n          try {\r\n            const signatureStatuses = await connection.getSignatureStatuses([\r\n              txid,\r\n            ]);\r\n            const result = signatureStatuses && signatureStatuses.value[0];\r\n            if (!done) {\r\n              if (!result) {\r\n                console.log('REST null result for', txid, result);\r\n              } else if (result.err) {\r\n                console.log('REST error for', txid, result);\r\n                done = true;\r\n                reject(result.err);\r\n              } else if (!result.confirmations) {\r\n                console.log('REST no confirmations for', txid, result);\r\n              } else {\r\n                console.log('REST confirmation for', txid, result);\r\n                done = true;\r\n                resolve(result);\r\n              }\r\n            }\r\n          } catch (e) {\r\n            if (!done) {\r\n              console.log('REST connection error: txid', txid, e);\r\n            }\r\n          }\r\n        })();\r\n        await sleep(300);\r\n      }\r\n    })();\r\n  });\r\n  done = true;\r\n  return result;\r\n}\r\n\r\nfunction mergeTransactions(transactions: (Transaction | undefined)[]) {\r\n  const transaction = new Transaction();\r\n  transactions\r\n    .filter((t): t is Transaction => t !== undefined)\r\n    .forEach((t) => {\r\n      transaction.add(t);\r\n    });\r\n  return transaction;\r\n}\r\n\r\nfunction jsonRpcResult(resultDescription: any) {\r\n  const jsonRpcVersion = struct.literal('2.0');\r\n  return struct.union([\r\n    struct({\r\n      jsonrpc: jsonRpcVersion,\r\n      id: 'string',\r\n      error: 'any',\r\n    }),\r\n    struct({\r\n      jsonrpc: jsonRpcVersion,\r\n      id: 'string',\r\n      error: 'null?',\r\n      result: resultDescription,\r\n    }),\r\n  ]);\r\n}\r\n\r\nfunction jsonRpcResultAndContext(resultDescription: any) {\r\n  return jsonRpcResult({\r\n    context: struct({\r\n      slot: 'number',\r\n    }),\r\n    value: resultDescription,\r\n  });\r\n}\r\n\r\nconst AccountInfoResult = struct({\r\n  executable: 'boolean',\r\n  owner: 'string',\r\n  lamports: 'number',\r\n  data: 'any',\r\n  rentEpoch: 'number?',\r\n});\r\n\r\nexport const GetMultipleAccountsAndContextRpcResult = jsonRpcResultAndContext(\r\n  struct.array([struct.union(['null', AccountInfoResult])]),\r\n);\r\n\r\nexport async function getMultipleSolanaAccounts(\r\n  connection: Connection,\r\n  publicKeys: PublicKey[],\r\n): Promise<\r\n  RpcResponseAndContext<{ [key: string]: AccountInfo<Buffer> | null }>\r\n> {\r\n  const args = [publicKeys.map((k) => k.toBase58()), { commitment: 'recent' }];\r\n  // @ts-ignore\r\n  const unsafeRes = await connection._rpcRequest('getMultipleAccounts', args);\r\n  const res = GetMultipleAccountsAndContextRpcResult(unsafeRes);\r\n  if (res.error) {\r\n    throw new Error(\r\n      'failed to get info about accounts ' +\r\n        publicKeys.map((k) => k.toBase58()).join(', ') +\r\n        ': ' +\r\n        res.error.message,\r\n    );\r\n  }\r\n  assert(typeof res.result !== 'undefined');\r\n  const accounts: Array<{\r\n    executable: any;\r\n    owner: PublicKey;\r\n    lamports: any;\r\n    data: Buffer;\r\n  } | null> = [];\r\n  for (const account of res.result.value) {\r\n    let value: {\r\n      executable: any;\r\n      owner: PublicKey;\r\n      lamports: any;\r\n      data: Buffer;\r\n    } | null = null;\r\n    if (res.result.value) {\r\n      const { executable, owner, lamports, data } = account;\r\n      assert(data[1] === 'base64');\r\n      value = {\r\n        executable,\r\n        owner: new PublicKey(owner),\r\n        lamports,\r\n        data: Buffer.from(data[0], 'base64'),\r\n      };\r\n    }\r\n    accounts.push(value);\r\n  }\r\n  return {\r\n    context: {\r\n      slot: res.result.context.slot,\r\n    },\r\n    value: Object.fromEntries(\r\n      accounts.map((account, i) => [publicKeys[i].toBase58(), account]),\r\n    ),\r\n  };\r\n}\r\n\r\n/** Copy of Connection.simulateTransaction that takes a commitment parameter. */\r\nasync function simulateTransaction(\r\n  connection: Connection,\r\n  transaction: Transaction,\r\n  commitment: Commitment,\r\n): Promise<RpcResponseAndContext<SimulatedTransactionResponse>> {\r\n  // @ts-ignore\r\n  transaction.recentBlockhash = await connection._recentBlockhash(\r\n    // @ts-ignore\r\n    connection._disableBlockhashCaching,\r\n  );\r\n\r\n  const signData = transaction.serializeMessage();\r\n  // @ts-ignore\r\n  const wireTransaction = transaction._serialize(signData);\r\n  const encodedTransaction = wireTransaction.toString('base64');\r\n  const config: any = { encoding: 'base64', commitment };\r\n  const args = [encodedTransaction, config];\r\n\r\n  // @ts-ignore\r\n  const res = await connection._rpcRequest('simulateTransaction', args);\r\n  if (res.error) {\r\n    throw new Error('failed to simulate transaction: ' + res.error.message);\r\n  }\r\n  return res.result;\r\n}\r\n","import * as BufferLayout from 'buffer-layout';\r\nimport bs58 from 'bs58';\r\nimport {AccountInfo, Connection, PublicKey} from '@solana/web3.js';\r\nimport {WRAPPED_SOL_MINT} from '@project-serum/serum/lib/token-instructions';\r\nimport {TokenAccount} from './types';\r\nimport {TOKEN_MINTS} from '@project-serum/serum';\r\nimport {useAllMarkets, useCustomMarkets, useTokenAccounts} from './markets';\r\nimport {getMultipleSolanaAccounts} from './send';\r\nimport {useConnection} from './connection';\r\nimport {useAsyncData} from './fetch-loop';\r\nimport tuple from 'immutable-tuple';\r\nimport BN from 'bn.js';\r\nimport {useMemo} from 'react';\r\n\r\nexport const ACCOUNT_LAYOUT = BufferLayout.struct([\r\n  BufferLayout.blob(32, 'mint'),\r\n  BufferLayout.blob(32, 'owner'),\r\n  BufferLayout.nu64('amount'),\r\n  BufferLayout.blob(93),\r\n]);\r\n\r\nexport const MINT_LAYOUT = BufferLayout.struct([\r\n  BufferLayout.blob(36),\r\n  BufferLayout.blob(8, 'supply'),\r\n  BufferLayout.u8('decimals'),\r\n  BufferLayout.u8('initialized'),\r\n  BufferLayout.blob(36),\r\n]);\r\n\r\nexport function parseTokenAccountData(\r\n  data: Buffer,\r\n): { mint: PublicKey; owner: PublicKey; amount: number } {\r\n  let { mint, owner, amount } = ACCOUNT_LAYOUT.decode(data);\r\n  return {\r\n    mint: new PublicKey(mint),\r\n    owner: new PublicKey(owner),\r\n    amount,\r\n  };\r\n}\r\n\r\nexport interface MintInfo {\r\n  decimals: number;\r\n  initialized: boolean;\r\n  supply: BN;\r\n}\r\n\r\nexport function parseTokenMintData(data): MintInfo {\r\n  let { decimals, initialized, supply } = MINT_LAYOUT.decode(data);\r\n  return {\r\n    decimals,\r\n    initialized: !!initialized,\r\n    supply: new BN(supply, 10, 'le'),\r\n  };\r\n}\r\n\r\nexport function getOwnedAccountsFilters(publicKey: PublicKey) {\r\n  return [\r\n    {\r\n      memcmp: {\r\n        offset: ACCOUNT_LAYOUT.offsetOf('owner'),\r\n        bytes: publicKey.toBase58(),\r\n      },\r\n    },\r\n    {\r\n      dataSize: ACCOUNT_LAYOUT.span,\r\n    },\r\n  ];\r\n}\r\n\r\nexport const TOKEN_PROGRAM_ID = new PublicKey(\r\n  'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA',\r\n);\r\n\r\nexport async function getOwnedTokenAccounts(\r\n  connection: Connection,\r\n  publicKey: PublicKey,\r\n): Promise<Array<{ publicKey: PublicKey; accountInfo: AccountInfo<Buffer> }>> {\r\n  let filters = getOwnedAccountsFilters(publicKey);\r\n  // @ts-ignore\r\n  let resp = await connection._rpcRequest('getProgramAccounts', [\r\n    TOKEN_PROGRAM_ID.toBase58(),\r\n    {\r\n      commitment: connection.commitment,\r\n      filters,\r\n    },\r\n  ]);\r\n  if (resp.error) {\r\n    throw new Error(\r\n      'failed to get token accounts owned by ' +\r\n        publicKey.toBase58() +\r\n        ': ' +\r\n        resp.error.message,\r\n    );\r\n  }\r\n  return resp.result\r\n    .map(({ pubkey, account: { data, executable, owner, lamports } }) => ({\r\n      publicKey: new PublicKey(pubkey),\r\n      accountInfo: {\r\n        data: bs58.decode(data),\r\n        executable,\r\n        owner: new PublicKey(owner),\r\n        lamports,\r\n      },\r\n    }))\r\n    .filter(({ accountInfo }) => {\r\n      // TODO: remove this check once mainnet is updated\r\n      return filters.every((filter) => {\r\n        if (filter.dataSize) {\r\n          return accountInfo.data.length === filter.dataSize;\r\n        } else if (filter.memcmp) {\r\n          let filterBytes = bs58.decode(filter.memcmp.bytes);\r\n          return accountInfo.data\r\n            .slice(\r\n              filter.memcmp.offset,\r\n              filter.memcmp.offset + filterBytes.length,\r\n            )\r\n            .equals(filterBytes);\r\n        }\r\n        return false;\r\n      });\r\n    });\r\n}\r\n\r\nexport async function getTokenAccountInfo(\r\n  connection: Connection,\r\n  ownerAddress: PublicKey,\r\n) {\r\n  let [splAccounts, account] = await Promise.all([\r\n    getOwnedTokenAccounts(connection, ownerAddress),\r\n    connection.getAccountInfo(ownerAddress),\r\n  ]);\r\n  const parsedSplAccounts: TokenAccount[] = splAccounts.map(\r\n    ({ publicKey, accountInfo }) => {\r\n      return {\r\n        pubkey: publicKey,\r\n        account: accountInfo,\r\n        effectiveMint: parseTokenAccountData(accountInfo.data).mint,\r\n      };\r\n    },\r\n  );\r\n  return parsedSplAccounts.concat({\r\n    pubkey: ownerAddress,\r\n    account,\r\n    effectiveMint: WRAPPED_SOL_MINT,\r\n  });\r\n}\r\n\r\n// todo: use this to map custom mints to custom tickers. Add functionality once custom markets store mints\r\nexport function useMintToTickers(): { [mint: string]: string } {\r\n  const { customMarkets } = useCustomMarkets();\r\n  return useMemo(() => {\r\n    return Object.fromEntries(\r\n      TOKEN_MINTS.map((mint) => [mint.address.toBase58(), mint.name]),\r\n    );\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [customMarkets.length]);\r\n}\r\n\r\nconst _VERY_SLOW_REFRESH_INTERVAL = 5000 * 1000;\r\n\r\n// todo: move this to using mints stored in static market infos once custom markets support that.\r\nexport function useMintInfos(): [\r\n  (\r\n    | {\r\n        [mintAddress: string]: {\r\n          decimals: number;\r\n          initialized: boolean;\r\n        } | null;\r\n      }\r\n    | null\r\n    | undefined\r\n  ),\r\n  boolean,\r\n] {\r\n  const connection = useConnection();\r\n  const [tokenAccounts] = useTokenAccounts();\r\n  const [allMarkets] = useAllMarkets();\r\n\r\n  const allMints = (tokenAccounts || [])\r\n    .map((account) => account.effectiveMint)\r\n    .concat(\r\n      (allMarkets || []).map((marketInfo) => marketInfo.market.baseMintAddress),\r\n    )\r\n    .concat(\r\n      (allMarkets || []).map(\r\n        (marketInfo) => marketInfo.market.quoteMintAddress,\r\n      ),\r\n    );\r\n  const uniqueMints = [...new Set(allMints.map((mint) => mint.toBase58()))].map(\r\n    (stringMint) => new PublicKey(stringMint),\r\n  );\r\n\r\n  const getAllMintInfo = async () => {\r\n    const mintInfos = await getMultipleSolanaAccounts(connection, uniqueMints);\r\n    return Object.fromEntries(\r\n      Object.entries(mintInfos.value).map(([key, accountInfo]) => [\r\n        key,\r\n        accountInfo && parseTokenMintData(accountInfo.data),\r\n      ]),\r\n    );\r\n  };\r\n\r\n  return useAsyncData(\r\n    getAllMintInfo,\r\n    tuple(\r\n      'getAllMintInfo',\r\n      connection,\r\n      (tokenAccounts || []).length,\r\n      (allMarkets || []).length,\r\n    ),\r\n    { refreshInterval: _VERY_SLOW_REFRESH_INTERVAL },\r\n  );\r\n}\r\n","import { BonfidaTrade } from './types';\r\n\r\nexport default class BonfidaApi {\r\n  static URL: string = 'http://localhost:5000/';\r\n  // static URL: string = 'http://soltoolstv.net/';\r\n\r\n  static async get(path: string) {\r\n    try {\r\n      const response = await fetch(this.URL + path);\r\n      if (response.ok) {\r\n        const responseJson = await response.json();\r\n        return responseJson.success ? responseJson.data : null;\r\n      }\r\n    } catch (err) {\r\n      console.log(`Error fetching from Bonfida API ${path}: ${err}`);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  static async getRecentTrades(\r\n    marketAddress: string,\r\n  ): Promise<BonfidaTrade[] | null> {\r\n    return BonfidaApi.get(`trades/address/${marketAddress}`);\r\n  }\r\n}\r\n\r\nexport const BONFIDA_DATA_FEED = 'http://localhost:5000/tv';\r\n// export const BONFIDA_DATA_FEED = 'https://soltoolstv.net/tv';\r\n","import {Market, MARKETS, OpenOrders, Orderbook, TOKEN_MINTS, TokenInstructions,} from '@project-serum/serum';\r\nimport {PublicKey} from '@solana/web3.js';\r\nimport React, {useContext, useEffect, useState} from 'react';\r\nimport {divideBnToNumber, floorToDecimal, getTokenMultiplierFromDecimals, sleep, useLocalStorageState,} from './utils';\r\nimport {refreshCache, useAsyncData} from './fetch-loop';\r\nimport {useAccountData, useAccountInfo, useConnection} from './connection';\r\nimport {useWallet} from './wallet';\r\nimport tuple from 'immutable-tuple';\r\nimport {notify} from './notifications';\r\nimport BN from 'bn.js';\r\nimport {getTokenAccountInfo, parseTokenAccountData, useMintInfos,} from './tokens';\r\nimport {\r\n  Balances,\r\n  CustomMarketInfo,\r\n  DeprecatedOpenOrdersBalances,\r\n  FullMarketInfo,\r\n  MarketContextValues,\r\n  MarketInfo,\r\n  OrderWithMarketAndMarketName,\r\n  SelectedTokenAccounts,\r\n  TokenAccount,\r\n} from './types';\r\nimport {WRAPPED_SOL_MINT} from '@project-serum/serum/lib/token-instructions';\r\nimport {Order} from '@project-serum/serum/lib/market';\r\nimport BonfidaApi, { BONFIDA_DATA_FEED } from './bonfidaConnector';\r\nimport { urlMarket } from '../pages/TradePage';\r\n\r\n// Used in debugging, should be false in production\r\nconst _IGNORE_DEPRECATED = false;\r\nexport var urlSymbol = '';\r\n\r\nexport const USE_MARKETS: MarketInfo[] = _IGNORE_DEPRECATED\r\n  ? MARKETS.map((m) => ({ ...m, deprecated: false }))\r\n  : MARKETS;\r\n\r\nexport function useMarketsList() {\r\n  return USE_MARKETS.filter(({ name, deprecated }) => !deprecated && !process.env.REACT_APP_EXCLUDE_MARKETS?.includes(name));\r\n}\r\n\r\nexport function useAllMarkets() {\r\n  const connection = useConnection();\r\n  const { customMarkets } = useCustomMarkets();\r\n\r\n  const getAllMarkets = async () => {\r\n    const markets: Array<{\r\n      market: Market;\r\n      marketName: string;\r\n      programId: PublicKey;\r\n    } | null> = await Promise.all(\r\n      getMarketInfos(customMarkets).map(async (marketInfo) => {\r\n        try {\r\n          const market = await Market.load(\r\n            connection,\r\n            marketInfo.address,\r\n            {},\r\n            marketInfo.programId,\r\n          );\r\n          return {\r\n            market,\r\n            marketName: marketInfo.name,\r\n            programId: marketInfo.programId,\r\n          };\r\n        } catch (e) {\r\n          notify({\r\n            message: 'Error loading all market',\r\n            description: e.message,\r\n            type: 'error',\r\n          });\r\n          return null;\r\n        }\r\n      }),\r\n    );\r\n    return markets.filter(\r\n      (m): m is { market: Market; marketName: string; programId: PublicKey } =>\r\n        !!m,\r\n    );\r\n  };\r\n  return useAsyncData(\r\n    getAllMarkets,\r\n    tuple('getAllMarkets', customMarkets.length, connection),\r\n    { refreshInterval: _VERY_SLOW_REFRESH_INTERVAL },\r\n  );\r\n}\r\n\r\nexport function useUnmigratedOpenOrdersAccounts() {\r\n  const connection = useConnection();\r\n  const { wallet } = useWallet();\r\n\r\n  async function getUnmigratedOpenOrdersAccounts(): Promise<OpenOrders[]> {\r\n    if (!wallet || !connection || !wallet.publicKey) {\r\n      return [];\r\n    }\r\n    console.log('refreshing useUnmigratedOpenOrdersAccounts');\r\n    let deprecatedOpenOrdersAccounts: OpenOrders[] = [];\r\n    const deprecatedProgramIds = Array.from(\r\n      new Set(\r\n        USE_MARKETS.filter(\r\n          ({ deprecated }) => deprecated,\r\n        ).map(({ programId }) => programId.toBase58()),\r\n      ),\r\n    ).map((publicKeyStr) => new PublicKey(publicKeyStr));\r\n    let programId: PublicKey;\r\n    for (programId of deprecatedProgramIds) {\r\n      try {\r\n        const openOrdersAccounts = await OpenOrders.findForOwner(\r\n          connection,\r\n          wallet.publicKey,\r\n          programId,\r\n        );\r\n        deprecatedOpenOrdersAccounts = deprecatedOpenOrdersAccounts.concat(\r\n          openOrdersAccounts\r\n            .filter(\r\n              (openOrders) =>\r\n                openOrders.baseTokenTotal.toNumber() ||\r\n                openOrders.quoteTokenTotal.toNumber(),\r\n            )\r\n            .filter((openOrders) =>\r\n              USE_MARKETS.some(\r\n                (market) =>\r\n                  market.deprecated && market.address.equals(openOrders.market),\r\n              ),\r\n            ),\r\n        );\r\n      } catch (e) {\r\n        console.log(\r\n          'Error loading deprecated markets',\r\n          programId?.toBase58(),\r\n          e.message,\r\n        );\r\n      }\r\n    }\r\n    // Maybe sort\r\n    return deprecatedOpenOrdersAccounts;\r\n  }\r\n\r\n  const cacheKey = tuple(\r\n    'getUnmigratedOpenOrdersAccounts',\r\n    connection,\r\n    wallet?.publicKey?.toBase58(),\r\n  );\r\n  const [accounts] = useAsyncData(getUnmigratedOpenOrdersAccounts, cacheKey, {\r\n    refreshInterval: _VERY_SLOW_REFRESH_INTERVAL,\r\n  });\r\n\r\n  return {\r\n    accounts,\r\n    refresh: (clearCache: boolean) => refreshCache(cacheKey, clearCache),\r\n  };\r\n}\r\n\r\nconst MarketContext: React.Context<null | MarketContextValues> = React.createContext<null | MarketContextValues>(\r\n  null,\r\n);\r\n\r\nconst _VERY_SLOW_REFRESH_INTERVAL = 5000 * 1000;\r\n\r\n// For things that don't really change\r\nconst _SLOW_REFRESH_INTERVAL = 5 * 1000;\r\n\r\n// For things that change frequently\r\nconst _FAST_REFRESH_INTERVAL = 1000;\r\n\r\nexport const DEFAULT_MARKET = USE_MARKETS.find(\r\n  ({ name, deprecated }) => name === 'SRM/USDT' && !deprecated,\r\n);\r\n\r\nexport function getMarketDetails(\r\n  market: string | undefined | null,\r\n  customMarkets: CustomMarketInfo[],\r\n) {\r\n  if (!market) {\r\n    return {};\r\n  }\r\n  const marketInfos = getMarketInfos(customMarkets);\r\n  // const marketInfo = marketInfos.find((otherMarket) =>\r\n  //   otherMarket.address.equals(market.address),\r\n  // );\r\n  // const baseCurrency =\r\n  //   (market?.baseMintAddress &&\r\n  //     TOKEN_MINTS.find((token) => token.address.equals(market.baseMintAddress))\r\n  //       ?.name) ||\r\n  //   (marketInfo?.baseLabel && `${marketInfo?.baseLabel}*`) ||\r\n  //   'UNKNOWN';\r\n  // const quoteCurrency =\r\n  //   (market?.quoteMintAddress &&\r\n  //     TOKEN_MINTS.find((token) => token.address.equals(market.quoteMintAddress))\r\n  //       ?.name) ||\r\n  //   (marketInfo?.quoteLabel && `${marketInfo?.quoteLabel}*`) ||\r\n  //   'UNKNOWN';\r\n\r\n  // return {\r\n  //   ...marketInfo,\r\n  //   marketName: marketInfo?.name,\r\n  //   baseCurrency,\r\n  //   quoteCurrency,\r\n  //   marketInfo,\r\n  // };\r\n}\r\n\r\nexport function useCustomMarkets() {\r\n  const [customMarkets, setCustomMarkets] = useLocalStorageState<\r\n    CustomMarketInfo[]\r\n  >('customMarkets', []);\r\n  return { customMarkets, setCustomMarkets };\r\n}\r\n\r\nexport function MarketProvider({ marketAddress, setMarketAddress, children }) {\r\n  const { customMarkets, setCustomMarkets } = useCustomMarkets();\r\n\r\n  console.log(\"MarketProvider marketAddress: \" + marketAddress);\r\n  const address = marketAddress && new PublicKey(marketAddress);\r\n  const connection = useConnection();\r\n  const marketInfos = getMarketInfos(customMarkets);\r\n  const marketInfo =\r\n    address && marketInfos.find((market) => market.address.equals(address));\r\n\r\n  const [market, setMarket] = useState<string | null>();\r\n  useEffect(() => {\r\n    if (\r\n      market &&\r\n      marketInfo &&\r\n      // @ts-ignore\r\n      market._decoded.ownAddress?.equals(marketInfo?.address)\r\n    ) {\r\n      console.log(\"exiting early for some reason..\");\r\n      return;\r\n    }\r\n    setMarket(null);\r\n    // if (!marketInfo || !marketInfo.address) {\r\n    //   notify({\r\n    //     message: 'Error loading market',\r\n    //     description: 'Please select a market from the dropdown',\r\n    //     type: 'error',\r\n    //   });\r\n    //   console.log(\"second exit early..\");\r\n    //   return;\r\n    // }\r\n    // Market.load(connection, marketInfo.address, {}, marketInfo.programId)\r\n    fetch(BONFIDA_DATA_FEED+\"/getsymbolfrommarketid?marketId=\" + marketAddress).then(res => res.json()).then((data) => {\r\n      console.log(\"just got marketName: \" + data[0].marketName);\r\n      return data[0].marketName;\r\n    }).then(setMarket)\r\n\r\n      .catch((e) =>\r\n        notify({\r\n          message: 'Error loading market',\r\n          description: e.message,\r\n          type: 'error',\r\n        }),\r\n      );\r\n    // eslint-disable-next-line\r\n  }, [connection, marketInfo]);\r\n\r\n  return (\r\n    <MarketContext.Provider\r\n      value={{\r\n        market,\r\n      }}\r\n    >\r\n      {children}\r\n    </MarketContext.Provider>\r\n  );\r\n}\r\n\r\nexport function getUrlMarket(marketId) {\r\n  fetch(BONFIDA_DATA_FEED+\"/getsymbolfrommarketid?marketId=\" + marketId).then(res => res.json()).then((data) => {\r\n      console.log(\"getSymbol data: \" + data);\r\n      console.log(\"getSymbol data.marketName: \" + data[0].marketName);\r\n      return data[0].marketName;\r\n  }).catch(e => {\r\n    console.log(`Error getting symbol from ${marketId}: ${e} `);\r\n    return \"\";\r\n  });\r\n}\r\n\r\nexport function getTradePageUrl(marketAddress?: string) {\r\n  if (marketAddress == null || marketAddress == undefined) {\r\n    marketAddress = \"9aruV2p8cRWxybx6wMsJwPFqeN7eQVPR74RrxdM3DNdu\";\r\n  }\r\n  console.log(\"marketAddress: \" + marketAddress);\r\n  fetch(BONFIDA_DATA_FEED+\"/getsymbolfrommarketid?marketId=\" + marketAddress).then(res => res.json()).then((data) => {\r\n      console.log(\"getSymbol data: \" + data);\r\n      console.log(\"getSymbol data.marketName: \" + data[0].marketName);\r\n      urlSymbol = data[0].marketName;\r\n  }).catch(e => {\r\n    console.log(`Error getting symbol from ${marketAddress}: ${e} `);\r\n  });\r\n  return `/market/${marketAddress}`;\r\n}\r\n\r\nexport function useSelectedTokenAccounts(): [\r\n  SelectedTokenAccounts,\r\n  (newSelectedTokenAccounts: SelectedTokenAccounts) => void,\r\n] {\r\n  const [\r\n    selectedTokenAccounts,\r\n    setSelectedTokenAccounts,\r\n  ] = useLocalStorageState<SelectedTokenAccounts>('selectedTokenAccounts', {});\r\n  return [selectedTokenAccounts, setSelectedTokenAccounts];\r\n}\r\n\r\nexport function useMarket() {\r\n  const context = useContext(MarketContext);\r\n  if (!context) {\r\n    throw new Error('Missing market context');\r\n  }\r\n  return context;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function useTokenAccounts(): [\r\n  TokenAccount[] | null | undefined,\r\n  boolean,\r\n] {\r\n  const { connected, wallet } = useWallet();\r\n  const connection = useConnection();\r\n  async function getTokenAccounts() {\r\n    if (!connected || !wallet) {\r\n      return null;\r\n    }\r\n    return await getTokenAccountInfo(connection, wallet.publicKey);\r\n  }\r\n  return useAsyncData(\r\n    getTokenAccounts,\r\n    tuple('getTokenAccounts', wallet, connected),\r\n    { refreshInterval: _SLOW_REFRESH_INTERVAL },\r\n  );\r\n}\r\n\r\nexport function getSelectedTokenAccountForMint(\r\n  accounts: TokenAccount[] | undefined | null,\r\n  mint: PublicKey | undefined,\r\n  selectedPubKey?: string | PublicKey | null,\r\n) {\r\n  if (!accounts || !mint) {\r\n    return null;\r\n  }\r\n  const filtered = accounts.filter(\r\n    ({ effectiveMint, pubkey }) =>\r\n      mint.equals(effectiveMint) &&\r\n      (!selectedPubKey ||\r\n        (typeof selectedPubKey === 'string'\r\n          ? selectedPubKey\r\n          : selectedPubKey.toBase58()) === pubkey.toBase58()),\r\n  );\r\n  return filtered && filtered[0];\r\n}\r\n\r\nexport function useLocallyStoredFeeDiscountKey(): {\r\n  storedFeeDiscountKey: PublicKey | undefined;\r\n  setStoredFeeDiscountKey: (key: string) => void;\r\n} {\r\n  const [\r\n    storedFeeDiscountKey,\r\n    setStoredFeeDiscountKey,\r\n  ] = useLocalStorageState<string>(`feeDiscountKey`, undefined);\r\n  return {\r\n    storedFeeDiscountKey: storedFeeDiscountKey\r\n      ? new PublicKey(storedFeeDiscountKey)\r\n      : undefined,\r\n    setStoredFeeDiscountKey,\r\n  };\r\n}\r\n\r\nexport function useAllOpenOrdersAccounts() {\r\n  const { wallet, connected } = useWallet();\r\n  const connection = useConnection();\r\n  const marketInfos = useMarketInfos();\r\n  const programIds = [\r\n    ...new Set(marketInfos.map((info) => info.programId.toBase58())),\r\n  ].map((stringProgramId) => new PublicKey(stringProgramId));\r\n\r\n  const getAllOpenOrdersAccounts = async () => {\r\n    if (!connected || !wallet) {\r\n      return [];\r\n    }\r\n    return (\r\n      await Promise.all(\r\n        programIds.map((programId) =>\r\n          OpenOrders.findForOwner(connection, wallet.publicKey, programId),\r\n        ),\r\n      )\r\n    ).flat();\r\n  };\r\n  return useAsyncData(\r\n    getAllOpenOrdersAccounts,\r\n    tuple(\r\n      'getAllOpenOrdersAccounts',\r\n      connection,\r\n      connected,\r\n      wallet?.publicKey?.toBase58(),\r\n      marketInfos.length,\r\n      (programIds || []).length,\r\n    ),\r\n    { refreshInterval: _SLOW_REFRESH_INTERVAL },\r\n  );\r\n}\r\n\r\nexport function useAllOpenOrdersBalances() {\r\n  const [\r\n    openOrdersAccounts,\r\n    loadedOpenOrdersAccounts,\r\n  ] = useAllOpenOrdersAccounts();\r\n  const [mintInfos, mintInfosConnected] = useMintInfos();\r\n  const [allMarkets] = useAllMarkets();\r\n  if (!loadedOpenOrdersAccounts || !mintInfosConnected) {\r\n    return {};\r\n  }\r\n\r\n  const marketsByAddress = Object.fromEntries(\r\n    (allMarkets || []).map((m) => [m.market.address.toBase58(), m]),\r\n  );\r\n  const openOrdersBalances: {\r\n    [mint: string]: { market: PublicKey; free: number; total: number }[];\r\n  } = {};\r\n  for (let account of openOrdersAccounts || []) {\r\n    const marketInfo = marketsByAddress[account.market.toBase58()];\r\n    const baseMint = marketInfo?.market.baseMintAddress.toBase58();\r\n    const quoteMint = marketInfo?.market.quoteMintAddress.toBase58();\r\n    if (!(baseMint in openOrdersBalances)) {\r\n      openOrdersBalances[baseMint] = [];\r\n    }\r\n    if (!(quoteMint in openOrdersBalances)) {\r\n      openOrdersBalances[quoteMint] = [];\r\n    }\r\n\r\n    const baseMintInfo = mintInfos && mintInfos[baseMint];\r\n    const baseFree = divideBnToNumber(\r\n      new BN(account.baseTokenFree),\r\n      getTokenMultiplierFromDecimals(baseMintInfo?.decimals || 0),\r\n    );\r\n    const baseTotal = divideBnToNumber(\r\n      new BN(account.baseTokenTotal),\r\n      getTokenMultiplierFromDecimals(baseMintInfo?.decimals || 0),\r\n    );\r\n    const quoteMintInfo = mintInfos && mintInfos[quoteMint];\r\n    const quoteFree = divideBnToNumber(\r\n      new BN(account.quoteTokenFree),\r\n      getTokenMultiplierFromDecimals(quoteMintInfo?.decimals || 0),\r\n    );\r\n    const quoteTotal = divideBnToNumber(\r\n      new BN(account.quoteTokenTotal),\r\n      getTokenMultiplierFromDecimals(quoteMintInfo?.decimals || 0),\r\n    );\r\n\r\n    openOrdersBalances[baseMint].push({\r\n      market: account.market,\r\n      free: baseFree,\r\n      total: baseTotal,\r\n    });\r\n    openOrdersBalances[quoteMint].push({\r\n      market: account.market,\r\n      free: quoteFree,\r\n      total: quoteTotal,\r\n    });\r\n  }\r\n  return openOrdersBalances;\r\n}\r\n\r\nexport const useAllOpenOrders = (): {\r\n  openOrders: { orders: Order[]; marketAddress: string }[] | null | undefined;\r\n  loaded: boolean;\r\n  refreshOpenOrders: () => void;\r\n} => {\r\n  const connection = useConnection();\r\n  const { connected, wallet } = useWallet();\r\n  const [loaded, setLoaded] = useState(false);\r\n  const [refresh, setRefresh] = useState(0);\r\n  const [openOrders, setOpenOrders] = useState<\r\n    { orders: Order[]; marketAddress: string }[] | null | undefined\r\n  >(null);\r\n  const [lastRefresh, setLastRefresh] = useState(0);\r\n\r\n  const refreshOpenOrders = () => {\r\n    if (new Date().getTime() - lastRefresh > 10 * 1000) {\r\n      setRefresh((prev) => prev + 1);\r\n    } else {\r\n      console.log('not refreshing');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (connected && wallet) {\r\n      const getAllOpenOrders = async () => {\r\n        setLoaded(false);\r\n        const _openOrders: { orders: Order[]; marketAddress: string }[] = [];\r\n        const getOpenOrdersForMarket = async (marketInfo: MarketInfo) => {\r\n          await sleep(1000 * Math.random()); // Try not to hit rate limit\r\n          try {\r\n            const market = await Market.load(\r\n              connection,\r\n              marketInfo.address,\r\n              undefined,\r\n              marketInfo.programId,\r\n            );\r\n            const orders = await market.loadOrdersForOwner(\r\n              connection,\r\n              wallet?.publicKey,\r\n              30000,\r\n            );\r\n            _openOrders.push({\r\n              orders: orders,\r\n              marketAddress: marketInfo.address.toBase58(),\r\n            });\r\n          } catch (e) {\r\n            console.warn(`Error loading open order ${marketInfo.name} - ${e}`);\r\n          }\r\n        };\r\n        await Promise.all(USE_MARKETS.map((m) => getOpenOrdersForMarket(m)));\r\n        setOpenOrders(_openOrders);\r\n        setLastRefresh(new Date().getTime());\r\n        setLoaded(true);\r\n      };\r\n      getAllOpenOrders();\r\n    }\r\n  }, [connection, connected, wallet, refresh]);\r\n  return {\r\n    openOrders: openOrders,\r\n    loaded: loaded,\r\n    refreshOpenOrders: refreshOpenOrders,\r\n  };\r\n};\r\n\r\nexport function useWalletBalancesForAllMarkets(): {\r\n  mint: string;\r\n  balance: number;\r\n}[] {\r\n  const [tokenAccounts] = useTokenAccounts();\r\n  const { connected } = useWallet();\r\n  const [mintInfos, mintInfosConnected] = useMintInfos();\r\n\r\n  if (!connected || !mintInfosConnected) {\r\n    return [];\r\n  }\r\n\r\n  let balances: { [mint: string]: number } = {};\r\n  for (let account of tokenAccounts || []) {\r\n    if (!account.account) {\r\n      continue;\r\n    }\r\n    let parsedAccount;\r\n    if (account.effectiveMint.equals(WRAPPED_SOL_MINT)) {\r\n      parsedAccount = {\r\n        mint: WRAPPED_SOL_MINT,\r\n        owner: account.pubkey,\r\n        amount: account.account.lamports,\r\n      };\r\n    } else {\r\n      parsedAccount = parseTokenAccountData(account.account.data);\r\n    }\r\n    if (!(parsedAccount.mint.toBase58() in balances)) {\r\n      balances[parsedAccount.mint.toBase58()] = 0;\r\n    }\r\n    const mintInfo = mintInfos && mintInfos[parsedAccount.mint.toBase58()];\r\n    const additionalAmount = divideBnToNumber(\r\n      new BN(parsedAccount.amount),\r\n      getTokenMultiplierFromDecimals(mintInfo?.decimals || 0),\r\n    );\r\n    balances[parsedAccount.mint.toBase58()] += additionalAmount;\r\n  }\r\n  return Object.entries(balances).map(([mint, balance]) => {\r\n    return { mint, balance };\r\n  });\r\n}\r\n\r\nexport function useUnmigratedDeprecatedMarkets() {\r\n  const connection = useConnection();\r\n  const { accounts } = useUnmigratedOpenOrdersAccounts();\r\n  const marketsList =\r\n    accounts &&\r\n    Array.from(new Set(accounts.map((openOrders) => openOrders.market)));\r\n  const deps = marketsList && marketsList.map((m) => m.toBase58());\r\n\r\n  const useUnmigratedDeprecatedMarketsInner = async () => {\r\n    if (!marketsList) {\r\n      return null;\r\n    }\r\n    const getMarket = async (address) => {\r\n      const marketInfo = USE_MARKETS.find((market) =>\r\n        market.address.equals(address),\r\n      );\r\n      if (!marketInfo) {\r\n        console.log('Failed loading market');\r\n        notify({\r\n          message: 'Error loading market',\r\n          type: 'error',\r\n        });\r\n        return null;\r\n      }\r\n      try {\r\n        console.log('Loading market', marketInfo.name);\r\n        // NOTE: Should this just be cached by (connection, marketInfo.address, marketInfo.programId)?\r\n        return await Market.load(\r\n          connection,\r\n          marketInfo.address,\r\n          {},\r\n          marketInfo.programId,\r\n        );\r\n      } catch (e) {\r\n        console.log('Failed loading market', marketInfo.name, e);\r\n        notify({\r\n          message: 'Error loading market',\r\n          description: e.message,\r\n          type: 'error',\r\n        });\r\n        return null;\r\n      }\r\n    };\r\n    return (await Promise.all(marketsList.map(getMarket))).filter((x) => x);\r\n  };\r\n  const [markets] = useAsyncData(\r\n    useUnmigratedDeprecatedMarketsInner,\r\n    tuple(\r\n      'useUnmigratedDeprecatedMarketsInner',\r\n      connection,\r\n      deps && deps.toString(),\r\n    ),\r\n    { refreshInterval: _VERY_SLOW_REFRESH_INTERVAL },\r\n  );\r\n  if (!markets) {\r\n    return null;\r\n  }\r\n  return markets.map((market) => ({\r\n    market,\r\n    openOrdersList: accounts?.filter(\r\n      (openOrders) => market && openOrders.market.equals(market.address),\r\n    ),\r\n  }));\r\n}\r\n\r\nexport function getMarketInfos(\r\n  customMarkets: CustomMarketInfo[],\r\n): MarketInfo[] {\r\n  const customMarketsInfo = customMarkets.map((m) => ({\r\n    ...m,\r\n    address: new PublicKey(m.address),\r\n    programId: new PublicKey(m.programId),\r\n    deprecated: false,\r\n  }));\r\n\r\n  return [...customMarketsInfo, ...USE_MARKETS];\r\n}\r\n\r\nexport function useMarketInfos() {\r\n  const { customMarkets } = useCustomMarkets();\r\n  return getMarketInfos(customMarkets);\r\n}\r\n\r\n/**\r\n * If selling, choose min tick size. If buying choose a price\r\n * s.t. given the state of the orderbook, the order will spend\r\n * `cost` cost currency.\r\n *\r\n * @param orderbook serum Orderbook object\r\n * @param cost quantity to spend. Base currency if selling,\r\n *  quote currency if buying.\r\n * @param tickSizeDecimals size of price increment of the market\r\n */\r\nexport function getMarketOrderPrice(\r\n  orderbook: Orderbook,\r\n  cost: number,\r\n  tickSizeDecimals?: number,\r\n) {\r\n  if (orderbook.isBids) {\r\n    return orderbook.market.tickSize;\r\n  }\r\n  let spentCost = 0;\r\n  let price, sizeAtLevel, costAtLevel: number;\r\n  const asks = orderbook.getL2(1000);\r\n  for ([price, sizeAtLevel] of asks) {\r\n    costAtLevel = price * sizeAtLevel;\r\n    if (spentCost + costAtLevel > cost) {\r\n      break;\r\n    }\r\n    spentCost += costAtLevel;\r\n  }\r\n  const sendPrice = Math.min(price * 1.02, asks[0][0] * 1.05);\r\n  let formattedPrice;\r\n  if (tickSizeDecimals) {\r\n    formattedPrice = floorToDecimal(sendPrice, tickSizeDecimals);\r\n  } else {\r\n    formattedPrice = sendPrice;\r\n  }\r\n  return formattedPrice;\r\n}\r\n\r\nexport function getExpectedFillPrice(\r\n  orderbook: Orderbook,\r\n  cost: number,\r\n  tickSizeDecimals?: number,\r\n) {\r\n  let spentCost = 0;\r\n  let avgPrice = 0;\r\n  let price, sizeAtLevel, costAtLevel: number;\r\n  for ([price, sizeAtLevel] of orderbook.getL2(1000)) {\r\n    costAtLevel = (orderbook.isBids ? 1 : price) * sizeAtLevel;\r\n    if (spentCost + costAtLevel > cost) {\r\n      avgPrice += (cost - spentCost) * price;\r\n      spentCost = cost;\r\n      break;\r\n    }\r\n    avgPrice += costAtLevel * price;\r\n    spentCost += costAtLevel;\r\n  }\r\n  const totalAvgPrice = avgPrice / Math.min(cost, spentCost);\r\n  let formattedPrice;\r\n  if (tickSizeDecimals) {\r\n    formattedPrice = floorToDecimal(totalAvgPrice, tickSizeDecimals);\r\n  } else {\r\n    formattedPrice = totalAvgPrice;\r\n  }\r\n  return formattedPrice;\r\n}\r\n\r\nexport function useCurrentlyAutoSettling(): [boolean, (currentlyAutoSettling: boolean) => void] {\r\n  const [currentlyAutoSettling, setCurrentlyAutosettling] = useState<boolean>(false);\r\n  return [currentlyAutoSettling, setCurrentlyAutosettling];\r\n}\r\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport { Button, Col, Popover, Row, Select, Typography } from 'antd';\r\nimport styled from 'styled-components';\r\nimport ad from '../assets/ad.png';\r\nimport {\r\n  getTradePageUrl,\r\n  MarketProvider,\r\n  useMarket,\r\n  useMarketsList,\r\n  useUnmigratedDeprecatedMarkets,\r\n} from '../utils/markets';\r\nimport { notify } from '../utils/notifications';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport { sendToMinter } from '../utils/send';\r\nimport { useConnection } from '../utils/connection';\r\nimport { useWallet } from '../utils/wallet';\r\n\r\nconst { Option, OptGroup } = Select;\r\n\r\nconst Wrapper = styled.div`\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 16px 16px;\r\n  .borderNone .ant-select-selector {\r\n    border: none !important;\r\n  }\r\n`;\r\n\r\nexport var urlMarket = \"\";\r\n\r\nexport default function TradePage() {\r\n  const { marketAddress } = useParams();\r\n  console.log(\"marketAddress top level: \" + marketAddress);\r\n  urlMarket = marketAddress;\r\n  useEffect(() => {\r\n    if (marketAddress) {\r\n      localStorage.setItem('marketAddress', JSON.stringify(marketAddress));\r\n    }\r\n  }, [marketAddress]);\r\n  const history = useHistory();\r\n  function setMarketAddress(address) {\r\n    history.push(getTradePageUrl(address));\r\n  }\r\n\r\n  return (\r\n    <MarketProvider\r\n      marketAddress={marketAddress}\r\n      setMarketAddress={setMarketAddress}\r\n    >\r\n      <TradePageInner />\r\n    </MarketProvider>\r\n  );\r\n}\r\n\r\nfunction TradePageInner() {\r\n  const {\r\n    market,\r\n  } = useMarket();\r\n  const connection = useConnection();\r\n  const {wallet, connected} = useWallet();\r\n  const markets = useMarketsList();\r\n  const [handleDeprecated, setHandleDeprecated] = useState(false);\r\n  const [addMarketVisible, setAddMarketVisible] = useState(false);\r\n  const deprecatedMarkets = useUnmigratedDeprecatedMarkets();\r\n  const [dimensions, setDimensions] = useState({\r\n    height: window.innerHeight,\r\n    width: window.innerWidth,\r\n  });\r\n\r\n\r\n  const changeOrderRef = useRef<\r\n    ({ size, price }: { size?: number; price?: number }) => void\r\n  >();\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setDimensions({\r\n        height: window.innerHeight,\r\n        width: window.innerWidth,\r\n      });\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  const width = dimensions?.width;\r\n  const componentProps = {\r\n    onChangeOrderRef: (ref) => (changeOrderRef.current = ref),\r\n    onPrice: useCallback(\r\n      (price) => changeOrderRef.current && changeOrderRef.current({ price }),\r\n      [],\r\n    ),\r\n    onSize: useCallback(\r\n      (size) => changeOrderRef.current && changeOrderRef.current({ size }),\r\n      [],\r\n    ),\r\n  };\r\n  const component = (() => {\r\n    if (width < 1000) {\r\n      return <RenderSmaller {...componentProps} />;\r\n    } else if (width < 1450) {\r\n      return <RenderSmall {...componentProps} />;\r\n    } else {\r\n      return <RenderNormal {...{connection, connected, wallet}} />;\r\n    }\r\n  })();\r\n\r\n  return (\r\n    <>\r\n      <Wrapper>\r\n          {deprecatedMarkets && deprecatedMarkets.length > 0 && (\r\n            <React.Fragment>\r\n              <Col>\r\n                <Typography>\r\n                  You have unsettled funds on old markets! Please go through\r\n                  them to claim your funds.\r\n                </Typography>\r\n              </Col>\r\n              <Col>\r\n                <Button onClick={() => setHandleDeprecated(!handleDeprecated)}>\r\n                  {handleDeprecated ? 'View new markets' : 'Handle old markets'}\r\n                </Button>\r\n              </Col>\r\n            </React.Fragment>\r\n          )}\r\n        {component}\r\n      </Wrapper>\r\n    </>\r\n  );\r\n}\r\n\r\nconst RenderNormal = ({ connection, connected, wallet }) => {\r\n  return (\r\n    <>\r\n      <div style={{display: 'flex', justifyContent: 'center', paddingBottom:'2rem'}}>\r\n        <img src={ad} width=\"60%\" height=\"128px\"/>\r\n      </div>\r\n      <div style={{display: 'flex', justifyContent: 'center', paddingBottom:'2rem'}}>\r\n          <Button onClick={() => {\r\n            console.log('clicked bro');\r\n            if (connected && wallet) {\r\n              sendToMinter({connection, wallet});\r\n            } else {\r\n              notify({\r\n                message: 'Please connect your wallet to mint',\r\n                type: 'error',\r\n              });\r\n            }\r\n          }}>\r\n                  {'Mint TEST SolGlyph'}\r\n          </Button>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nconst RenderSmall = ({ onChangeOrderRef, onPrice, onSize }) => {\r\n  return (\r\n    <>\r\n      <div style={{display: 'flex', justifyContent: 'center', paddingBottom:'2rem'}}>\r\n        <img src={ad} width=\"90%\" height=\"90px\"/>\r\n      </div>\r\n      <div style={{display: 'flex', justifyContent: 'center', paddingBottom:'2rem'}}>\r\n        <Col flex=\"auto\" style={{ height: '900px', width: '100%', display: 'flex' }}>\r\n        </Col>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nconst RenderSmaller = ({ onChangeOrderRef, onPrice, onSize }) => {\r\n  return (\r\n    <>\r\n      <div style={{display: 'flex', justifyContent: 'center', paddingBottom:'2rem'}}>\r\n        <img src={ad} width=\"90%\" height=\"90px\"/>\r\n      </div>\r\n      <div style={{display: 'flex', justifyContent: 'center', paddingBottom:'2rem'}}>\r\n        <Col flex=\"auto\" style={{ height: '900px', width: '100%', display: 'flex' }}>\r\n        </Col>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { Row, Col } from 'antd';\r\n\r\nexport default function AboutPage() {\r\n    return (\r\n        <>\r\n            <div style={{ display: 'flex', justifyContent: 'center', paddingTop: '4rem', width: '100%' }}>\r\n                <h2 style={{ color: '#bc13fe', textAlign: 'center', width: '50%' }}>\r\n                    SolGlyphs. TODO.\r\n                </h2>\r\n            </div>\r\n            <div style={{ display: 'flex', justifyContent: 'center', paddingTop: '4rem', width: '100%' }}>\r\n                <h2 style={{ color: '#bc13fe', textAlign: 'center', paddingTop: '1rem', width: '50%' }}>\r\n                    SolGlyphs are NFTs that combine 3 random letters into a glyph. All possible combinations\r\n                    have exactly 1 NFT as part of the collection.\r\n                </h2>\r\n            </div>\r\n            <div style={{ display: 'flex', justifyContent: 'center', paddingTop: '4rem', width: '100%' }}>\r\n                <h2 style={{ color: '#bc13fe', textAlign: 'center', paddingTop: '1rem', width: '50%' }}>\r\n                </h2>\r\n            </div>\r\n        </>\r\n    );\r\n}","import { useRef, useEffect } from 'react';\r\n\r\nexport function useInterval(callback, delay) {\r\n  const savedCallback = useRef<() => void>();\r\n\r\n  // Remember the latest callback.\r\n  useEffect(() => {\r\n    savedCallback.current = callback;\r\n  }, [callback]);\r\n\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    function tick() {\r\n      savedCallback.current && savedCallback.current();\r\n    }\r\n    if (delay !== null) {\r\n      let id = setInterval(tick, delay);\r\n      return () => {\r\n        clearInterval(id);\r\n      };\r\n    }\r\n  }, [delay]);\r\n}\r\n","import React, {useContext, useState} from 'react';\r\nimport {sleep, useLocalStorageState} from './utils';\r\nimport {useInterval} from './useInterval';\r\nimport {useConnection} from './connection';\r\nimport {useWallet} from './wallet';\r\nimport {\r\n  useMarketInfos,\r\n  useTokenAccounts,\r\n} from './markets';\r\nimport {settleAllFunds} from './send';\r\nimport {PreferencesContextValues} from './types';\r\nimport {Market} from \"@project-serum/serum\";\r\n\r\nconst PreferencesContext = React.createContext<PreferencesContextValues | null>(\r\n  null,\r\n);\r\n\r\nexport function PreferencesProvider({ children }) {\r\n  const [autoSettleEnabled, setAutoSettleEnabled] = useLocalStorageState(\r\n    'autoSettleEnabled',\r\n    true,\r\n  );\r\n\r\n  const [tokenAccounts] = useTokenAccounts();\r\n  const { connected, wallet } = useWallet();\r\n  const marketInfoList = useMarketInfos();\r\n  const [currentlyFetchingMarkets, setCurrentlyFetchingMarkets] = useState<boolean>(false);\r\n  const [markets, setMarkets] = useState<Map<string, Market>>(new Map())\r\n  const addToMarketsMap = (marketId, market) => {\r\n    setMarkets(prev => new Map(prev).set(marketId, market));\r\n  }\r\n  const connection = useConnection();\r\n\r\n  useInterval(() => {\r\n    const autoSettle = async () => {\r\n      if (!wallet) {\r\n        return;\r\n      }\r\n      try {\r\n        console.log('Settling funds...');\r\n        await settleAllFunds({\r\n          connection,\r\n          wallet,\r\n          tokenAccounts: tokenAccounts || [],\r\n          markets: [...markets.values()],\r\n        });\r\n      } catch (e) {\r\n        console.log('Error auto settling funds: ' + e.message);\r\n        return;\r\n      }\r\n      console.log('Finished settling funds.');\r\n    };\r\n    (\r\n      connected &&\r\n      wallet?.autoApprove &&\r\n      autoSettleEnabled &&\r\n      autoSettle()\r\n    );\r\n  }, 20000);\r\n\r\n  // warms up the market and open orders cache for auto-settlement\r\n  useInterval(() => {\r\n    const fetchMarkets = async () => {\r\n      if (!wallet) {\r\n        // only need these markets for auto-settlement, so don't fetch unless we are connected.\r\n        return;\r\n      }\r\n      setCurrentlyFetchingMarkets(true);\r\n      for (const marketInfo of marketInfoList) {\r\n        if (markets.has(marketInfo.address.toString())) {\r\n          continue;\r\n        }\r\n        try {\r\n          const market = await Market.load(connection, marketInfo.address, {}, marketInfo.programId)\r\n          addToMarketsMap(marketInfo.address.toString(), market);\r\n          await sleep(1000);\r\n        } catch (e) {\r\n          console.log('Error fetching market: ' + e.message);\r\n        }\r\n      }\r\n      setCurrentlyFetchingMarkets(false);\r\n    }\r\n    (\r\n      connected &&\r\n      wallet?.autoApprove &&\r\n      autoSettleEnabled &&\r\n      !currentlyFetchingMarkets &&\r\n      fetchMarkets()\r\n    );\r\n  }, 60000)\r\n\r\n  return (\r\n    <PreferencesContext.Provider\r\n      value={{\r\n        autoSettleEnabled,\r\n        setAutoSettleEnabled,\r\n      }}\r\n    >\r\n      {children}\r\n    </PreferencesContext.Provider>\r\n  );\r\n}\r\n\r\nexport function usePreferences() {\r\n  const context = useContext(PreferencesContext);\r\n  if (!context) {\r\n    throw new Error('Missing preferences context');\r\n  }\r\n  return {\r\n    autoSettleEnabled: context.autoSettleEnabled,\r\n    setAutoSettleEnabled: context.setAutoSettleEnabled,\r\n  };\r\n}\r\n","import React from 'react';\r\nimport { Switch, Typography } from 'antd';\r\nimport { usePreferences } from '../utils/preferences';\r\n\r\nconst { Paragraph } = Typography;\r\n\r\nexport default function Settings({ autoApprove }) {\r\n  const { autoSettleEnabled, setAutoSettleEnabled } = usePreferences();\r\n\r\n  return (\r\n    <div>\r\n      <Switch\r\n        style={{ marginRight: 10 }}\r\n        disabled={!autoApprove}\r\n        checked={autoApprove && autoSettleEnabled}\r\n        onChange={setAutoSettleEnabled}\r\n      />{' '}\r\n      Auto settle\r\n      {!autoApprove && (\r\n        <Paragraph style={{ color: 'rgba(255,255,255,0.5)', marginTop: 10 }}>\r\n          To use auto settle, first enable auto approval in your wallet\r\n        </Paragraph>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Col, Input, Modal, Row } from 'antd';\r\nimport { EndpointInfo } from '../utils/types';\r\n\r\nexport default function CustomClusterEndpointDialog({\r\n  visible,\r\n  testingConnection,\r\n  onAddCustomEndpoint,\r\n  onClose,\r\n}: {\r\n  visible: boolean;\r\n  testingConnection: boolean;\r\n  onAddCustomEndpoint: (info: EndpointInfo) => void;\r\n  onClose?: () => void;\r\n}) {\r\n  const [customEndpoint, setCustomEndpoint] = useState('');\r\n  const [customEndpointName, setCustomEndpointName] = useState('');\r\n\r\n  const onSubmit = () => {\r\n    const fullEndpoint = 'https://' + customEndpoint;\r\n    const params = {\r\n      name: customEndpointName,\r\n      endpoint: fullEndpoint,\r\n      custom: true,\r\n    };\r\n    onAddCustomEndpoint(params);\r\n    onDoClose();\r\n  };\r\n  const onDoClose = () => {\r\n    setCustomEndpoint('');\r\n    setCustomEndpointName('');\r\n    onClose && onClose();\r\n  };\r\n  const canSubmit = customEndpoint !== '' && customEndpointName !== '';\r\n\r\n  return (\r\n    <Modal\r\n      title={'Add custom endpoint'}\r\n      visible={visible}\r\n      onOk={onSubmit}\r\n      okText={'Add'}\r\n      onCancel={onDoClose}\r\n      okButtonProps={{ disabled: !canSubmit, loading: testingConnection }}\r\n    >\r\n      <Row style={{ marginBottom: 8 }}>\r\n        <Col span={24}>\r\n          <Input\r\n            placeholder=\"Cluster Name\"\r\n            value={customEndpointName}\r\n            onChange={(e) => setCustomEndpointName(e.target.value)}\r\n          />\r\n        </Col>\r\n      </Row>\r\n      <Row style={{ marginBottom: 8 }}>\r\n        <Col span={24}>\r\n          <Input\r\n            placeholder=\"Cluster Endpoint\"\r\n            value={customEndpoint}\r\n            addonBefore={'https://'}\r\n            onChange={(e) => setCustomEndpoint(e.target.value)}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </Modal>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Button } from 'antd';\r\nimport { LinkOutlined } from '@ant-design/icons';\r\n\r\nexport default function LinkAddress({\r\n  title,\r\n  address,\r\n  shorten = false,\r\n}: {\r\n  title?: undefined | any;\r\n  address: string;\r\n  shorten?: boolean;\r\n}) {\r\n  return (\r\n    <div>\r\n      {title && <p style={{ color: 'white' }}>{title}</p>}\r\n      <Button\r\n        type=\"link\"\r\n        icon={<LinkOutlined />}\r\n        href={'https://explorer.solana.com/address/' + address}\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n        style={{ cursor: 'pointer' }}\r\n      >\r\n        {shorten ? `${address.slice(0, 4)}...${address.slice(-4)}` : address}\r\n      </Button>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Dropdown, Menu } from 'antd';\r\nimport { useWallet } from '../utils/wallet';\r\nimport LinkAddress from './LinkAddress';\r\n\r\nexport default function WalletConnect() {\r\n  const { connected, wallet, select, connect, disconnect } = useWallet();\r\n  const publicKey = (connected && wallet?.publicKey?.toBase58()) || '';\r\n\r\n  const menu = (\r\n    <Menu>\r\n      {connected && <LinkAddress shorten={true} address={publicKey} />}\r\n      <Menu.Item key=\"3\" onClick={select}>\r\n        Change Wallet\r\n      </Menu.Item>\r\n    </Menu>\r\n  );\r\n\r\n  return (\r\n    <Dropdown.Button onClick={connected ? disconnect : connect} overlay={menu}>\r\n      {connected ? 'Disconnect' : 'Connect'}\r\n    </Dropdown.Button>\r\n  );\r\n}\r\n","import {\r\n  InfoCircleOutlined,\r\n  PlusCircleOutlined,\r\n  SettingOutlined,\r\n} from '@ant-design/icons';\r\nimport { Button, Col, Menu, Popover, Row, Select } from 'antd';\r\nimport React, { useCallback, useEffect, useState } from 'react';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\nimport logo from '../assets/logo.png';\r\nimport styled from 'styled-components';\r\nimport { useWallet } from '../utils/wallet';\r\nimport { ENDPOINTS, useConnectionConfig } from '../utils/connection';\r\nimport Settings from './Settings';\r\nimport CustomClusterEndpointDialog from './CustomClusterEndpointDialog';\r\nimport { EndpointInfo } from '../utils/types';\r\nimport { notify } from '../utils/notifications';\r\nimport { Connection } from '@solana/web3.js';\r\nimport WalletConnect from './WalletConnect';\r\nimport AppSearch from './AppSearch';\r\nimport { getTradePageUrl } from '../utils/markets';\r\n\r\nconst Wrapper = styled.div`\r\n  background-color: #0d1017;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: flex-end;\r\n  padding: 0px 30px;\r\n  flex-wrap: wrap;\r\n`;\r\nconst LogoWrapper = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  color: #bc13fe;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  img {\r\n    height: 30px;\r\n    margin-right: 8px;\r\n  }\r\n`;\r\n\r\nconst EXTERNAL_LINKS = {\r\n  '/learn': 'https://serum-academy.com/en/serum-dex/',\r\n  '/add-market': 'https://serum-academy.com/en/add-market/',\r\n  '/wallet-support': 'https://serum-academy.com/en/wallet-support',\r\n  '/dex-list': 'https://serum-academy.com/en/dex-list/',\r\n  '/developer-resources': 'https://serum-academy.com/en/developer-resources/',\r\n  '/explorer': 'https://explorer.solana.com',\r\n  '/srm-faq': 'https://projectserum.com/srm-faq',\r\n  '/swap': 'https://swap.projectserum.com',\r\n};\r\n\r\nexport default function TopBar() {\r\n  const { connected, wallet } = useWallet();\r\n  const {\r\n    endpoint,\r\n    endpointInfo,\r\n    setEndpoint,\r\n    availableEndpoints,\r\n    setCustomEndpoints,\r\n  } = useConnectionConfig();\r\n  const [addEndpointVisible, setAddEndpointVisible] = useState(false);\r\n  const [testingConnection, setTestingConnection] = useState(false);\r\n  const location = useLocation();\r\n  const history = useHistory();\r\n  const [searchFocussed, setSearchFocussed] = useState(false);\r\n\r\n  const handleClick = useCallback(\r\n    (e) => {\r\n      if (!(e.key in EXTERNAL_LINKS)) {\r\n        history.push(e.key);\r\n      }\r\n    },\r\n    [history],\r\n  );\r\n\r\n  const onAddCustomEndpoint = (info: EndpointInfo) => {\r\n    const existingEndpoint = availableEndpoints.some(\r\n      (e) => e.endpoint === info.endpoint,\r\n    );\r\n    if (existingEndpoint) {\r\n      notify({\r\n        message: `An endpoint with the given url already exists`,\r\n        type: 'error',\r\n      });\r\n      return;\r\n    }\r\n\r\n    const handleError = (e) => {\r\n      console.log(`Connection to ${info.endpoint} failed: ${e}`);\r\n      notify({\r\n        message: `Failed to connect to ${info.endpoint}`,\r\n        type: 'error',\r\n      });\r\n    };\r\n\r\n    try {\r\n      const connection = new Connection(info.endpoint, 'recent');\r\n      connection\r\n        .getEpochInfo()\r\n        .then((result) => {\r\n          setTestingConnection(true);\r\n          console.log(`testing connection to ${info.endpoint}`);\r\n          const newCustomEndpoints = [\r\n            ...availableEndpoints.filter((e) => e.custom),\r\n            info,\r\n          ];\r\n          setEndpoint(info.endpoint);\r\n          setCustomEndpoints(newCustomEndpoints);\r\n        })\r\n        .catch(handleError);\r\n    } catch (e) {\r\n      handleError(e);\r\n    } finally {\r\n      setTestingConnection(false);\r\n    }\r\n  };\r\n\r\n  const endpointInfoCustom = endpointInfo && endpointInfo.custom;\r\n  useEffect(() => {\r\n    const handler = () => {\r\n      if (endpointInfoCustom) {\r\n        setEndpoint(ENDPOINTS[0].endpoint);\r\n      }\r\n    };\r\n    window.addEventListener('beforeunload', handler);\r\n    return () => window.removeEventListener('beforeunload', handler);\r\n  }, [endpointInfoCustom, setEndpoint]);\r\n\r\n  const tradePageUrl = location.pathname.startsWith('/market/')\r\n    ? location.pathname\r\n    : getTradePageUrl();\r\n\r\n  const [isShown, setAboutShown] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <CustomClusterEndpointDialog\r\n        visible={addEndpointVisible}\r\n        testingConnection={testingConnection}\r\n        onAddCustomEndpoint={onAddCustomEndpoint}\r\n        onClose={() => setAddEndpointVisible(false)}\r\n      />\r\n      <Wrapper>\r\n        <LogoWrapper onClick={() => history.push(tradePageUrl)}>\r\n          <img src={logo} alt=\"\" />\r\n          {'SolGlpyhs'}\r\n        </LogoWrapper>\r\n        <Menu\r\n          mode=\"horizontal\"\r\n          onClick={handleClick}\r\n          selectedKeys={[location.pathname]}\r\n          style={{\r\n            borderBottom: 'none',\r\n            backgroundColor: 'transparent',\r\n            display: 'flex',\r\n            alignItems: 'flex-end',\r\n            flex: 1,\r\n          }}\r\n        >\r\n          <Menu.Item key={tradePageUrl} style={{ margin: '0 10px 0 20px' }}>\r\n            GLYPHS\r\n          </Menu.Item>\r\n          {!searchFocussed && (\r\n            <Menu.Item key=\"/about\" style={{ margin: '0 10px' }}>\r\n              <a\r\n                href={EXTERNAL_LINKS['/about']}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                ABOUT\r\n              </a>\r\n            </Menu.Item>\r\n          )}\r\n          {/* <Menu.Item key={tradePageUrl} style={{ margin: '0 10px 0 20px' }}\r\n              onTitleClick={() =>\r\n                window.open(EXTERNAL_LINKS['/about'], '_blank')\r\n              }\r\n          >\r\n            ABOUT\r\n          </Menu.Item> */}\r\n        </Menu>\r\n        <div>\r\n          <Row\r\n            align=\"middle\"\r\n            style={{ paddingLeft: 5, paddingRight: 5 }}\r\n            gutter={16}\r\n          >\r\n            <Col>\r\n              <Popover\r\n                content={endpoint}\r\n                placement=\"bottomRight\"\r\n                title=\"URL\"\r\n                trigger=\"hover\"\r\n              >\r\n                <InfoCircleOutlined style={{ color: '#bc13fe' }} />\r\n              </Popover>\r\n            </Col>\r\n            <Col>\r\n              <Select\r\n                onSelect={setEndpoint}\r\n                value={endpoint}\r\n                style={{ marginRight: 8, width: '150px' }}\r\n              >\r\n                {availableEndpoints.map(({ name, endpoint }) => (\r\n                  <Select.Option value={endpoint} key={endpoint}>\r\n                    {name}\r\n                  </Select.Option>\r\n                ))}\r\n              </Select>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n        {connected && (\r\n          <div>\r\n            <Popover\r\n              content={<Settings autoApprove={wallet?.autoApprove} />}\r\n              placement=\"bottomRight\"\r\n              title=\"Settings\"\r\n              trigger=\"click\"\r\n            >\r\n              <Button style={{ marginRight: 8 }}>\r\n                <SettingOutlined />\r\n                Settings\r\n              </Button>\r\n            </Popover>\r\n          </div>\r\n        )}\r\n        <div>\r\n          <WalletConnect />\r\n        </div>\r\n      </Wrapper>\r\n    </>\r\n  );\r\n}\r\n","export const helpUrls = {\r\n  contactEmail: 'mailto:solglyphs@protonmail.com',\r\n  discord: 'https://discord.gg/',\r\n  solanaBeach: 'https://solanabeach.io',\r\n  twitter: 'https://twitter.com/SolGlyphs',\r\n};\r\n","import React from 'react';\r\nimport { Layout, Row, Col, Grid } from 'antd';\r\nimport Link from './Link';\r\nimport { helpUrls } from './HelpUrls';\r\nconst { Footer } = Layout;\r\nconst { useBreakpoint } = Grid;\r\n\r\nconst footerElements = [\r\n  { description: 'Discord', link: helpUrls.discord },\r\n  { description: 'Twitter', link: helpUrls.twitter },\r\n  { description: 'Solana Network', link: helpUrls.solanaBeach },\r\n];\r\n\r\nexport const CustomFooter = () => {\r\n  return (\r\n    <Footer\r\n      style={{\r\n        height: '45px',\r\n        paddingBottom: 10,\r\n        paddingTop: 10,\r\n      }}\r\n    >\r\n      <Row align=\"middle\" gutter={[16, 4]}>\r\n          <>\r\n            <Col flex=\"auto\" />\r\n            {footerElements.map((elem, index) => {\r\n              return (\r\n                <Col key={index + ''}>\r\n                  <Link external to={elem.link}>\r\n                    {elem.description}\r\n                  </Link>\r\n                </Col>\r\n              );\r\n            })}\r\n          </>\r\n        <Col flex=\"auto\">{/*  <DexProgramSelector />*/}</Col>\r\n      </Row>\r\n    </Footer>\r\n  );\r\n};\r\n","import { Layout } from 'antd';\r\nimport React from 'react';\r\nimport TopBar from './TopBar';\r\nimport { CustomFooter as Footer } from './Footer';\r\nconst { Header, Content } = Layout;\r\n\r\nexport default function BasicLayout({ children }) {\r\n  return (\r\n    <React.Fragment>\r\n      <Layout\r\n        style={{ display: 'flex', minHeight: '100vh', flexDirection: 'column' }}\r\n      >\r\n        <Header style={{ padding: 0, minHeight: 64, height: 'unset' }}>\r\n          <TopBar />\r\n        </Header>\r\n        <Content style={{ flex: 1 }}>{children}</Content>\r\n        <Footer />\r\n      </Layout>\r\n    </React.Fragment>\r\n  );\r\n}\r\n","import { HashRouter, Route, Switch, Redirect } from 'react-router-dom';\r\nimport TradePage from './pages/TradePage';\r\nimport OpenOrdersPage from './pages/OpenOrdersPage';\r\nimport React from 'react';\r\nimport BalancesPage from './pages/BalancesPage';\r\nimport AboutPage from './pages/AboutPage';\r\nimport BasicLayout from './components/BasicLayout';\r\nimport ListNewMarketPage from './pages/ListNewMarketPage';\r\nimport NewPoolPage from './pages/pools/NewPoolPage';\r\nimport PoolPage from './pages/pools/PoolPage';\r\nimport PoolListPage from './pages/pools/PoolListPage';\r\nimport { getTradePageUrl } from './utils/markets';\r\n\r\nexport function Routes() {\r\n  return (\r\n    <>\r\n      <HashRouter basename={'/'}>\r\n        <BasicLayout>\r\n          <Switch>\r\n            <Route exact path=\"/\">\r\n              <Redirect to={getTradePageUrl()} />\r\n            </Route>\r\n            <Route exact path=\"/market/:marketAddress\">\r\n              <TradePage />\r\n            </Route>\r\n            <Route exact path=\"/about\">\r\n              <AboutPage />\r\n            </Route>\r\n          </Switch>\r\n        </BasicLayout>\r\n      </HashRouter>\r\n    </>\r\n  );\r\n}\r\n","import React, { Suspense } from 'react';\r\nimport './App.less';\r\nimport { ConnectionProvider } from './utils/connection';\r\nimport { WalletProvider } from './utils/wallet';\r\nimport { GlobalStyle } from './global_style';\r\nimport { Spin } from 'antd';\r\nimport ErrorBoundary from './components/ErrorBoundary';\r\nimport { Routes } from './routes';\r\nimport { PreferencesProvider } from './utils/preferences';\r\n\r\nexport default function App() {\r\n  return (\r\n    <Suspense fallback={() => <Spin size=\"large\" />}>\r\n      <GlobalStyle />\r\n      <ErrorBoundary>\r\n        <ConnectionProvider>\r\n          <WalletProvider>\r\n            <PreferencesProvider>\r\n              <Suspense fallback={() => <Spin size=\"large\" />}>\r\n                <Routes />\r\n              </Suspense>\r\n            </PreferencesProvider>\r\n          </WalletProvider>\r\n        </ConnectionProvider>\r\n      </ErrorBoundary>\r\n    </Suspense>\r\n  );\r\n}\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\r\n    ),\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then((registration) => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then((response) => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then((registration) => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.',\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then((registration) => {\r\n        registration.unregister();\r\n      })\r\n      .catch((error) => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}